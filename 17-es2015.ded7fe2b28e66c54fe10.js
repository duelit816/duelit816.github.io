(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{XRCK:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),a=n("3Pt+"),s=n("1kSV"),r=n("ftNi"),c=n("fXoL");let o=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})(),l=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},imports:[[i.c,o]]}),e})(),u=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})(),p=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},imports:[[i.c,u]]}),e})();var b=n("S48G"),d=n("geAU"),m=n("tyNb"),g=n("Znnd"),h=n("wd/R"),f=n("XNiG"),y=n("2Vo4"),C=n("LRne"),T=n("1G5W"),v=n("JIr8"),O=n("lJxs"),S=n("5+tZ"),k=n("SLWe"),P=n("YGOX"),w=n("qc5V"),I=n("aVeI"),_=n("lbBO"),U=n("BamM"),x=n("J+vq"),$=n("h7dw");let A=(()=>{class e{constructor(e,t,n){this.el=e,this.renderer=t,this.keen=n,this.viewInit=!1,this.loading=!0}ngOnInit(){this.renderer.addClass(this.el.nativeElement,"duelit-keen-data")}ngOnChanges(){this.query&&this.viewInit&&(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.doQuery())}doQuery(){if(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.chart=new x.Dataviz({container:`.${this.duelitkeenname}`,title:"metric"===this.viewType&&this.title,type:this.viewType,legend:{pagination:{limit:10}},labelMapping:{Regular:"Challenge",Open:"Tournament","Practice game":"Practice"}}),this.query.eventCollection instanceof Array){const e=[];this.query.eventCollection.forEach(t=>{e.push(this.keen.query(this.queryType,{eventCollection:t,timeframe:this.query.timeframe,timezone:"UTC"}))}),this.keen.run(e).then(e=>{const t=[];t.push({type:"Accepted",result:e[1].result},{type:"Rejected",result:e[0].result-e[1].result}),this.chart.render({query:{timeframe:this.query.timeframe,timezone:"UTC"},result:t})})}else this.loading=!0,this.keen.query(this.queryType,this.query).then(e=>{setTimeout(()=>{this.isCombined&&this.apiResult?(e.result=[e.result.find(e=>"Practice game"===e["Game.type"])],this.apiResult.subscribe(t=>{t.forEach(t=>{e.result.push({"Game.type":t.type,result:t.count})}),this.chart.render(e)})):this.chart.render(e)}),this.loading=!1}).catch(e=>{setTimeout(()=>{this.chart.message(e.message)}),this.loading=!1})}ngAfterViewInit(){this.viewInit=!0,this.doQuery()}}return e.\u0275fac=function(t){return new(t||e)(c.Pb(c.l),c.Pb(c.F),c.Pb($.a))},e.\u0275dir=c.Kb({type:e,selectors:[["","duelitKeenData",""]],inputs:{duelitkeenname:"duelitkeenname",viewType:"viewType",queryType:"queryType",query:"query",title:"title",isCombined:"isCombined",apiResult:"apiResult"},features:[c.Ab()]}),e})(),j=(()=>{class e{constructor(){this.loading=!0,this.viewInit=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-keen"]],inputs:{title:"title",keenName:"keenName",viewType:"viewType",queryType:"queryType",query:"query",subTitle:"subTitle",isCombined:"isCombined",apiResult:"apiResult"},decls:3,vars:11,consts:[["duelitKeenData","",1,"duelit-keen-data",3,"duelitkeenname","viewType","queryType","query","title","ngClass","isCombined","apiResult"]],template:function(e,t){1&e&&(c.Vb(0,"h6"),c.Lc(1),c.Ub(),c.Qb(2,"div",0)),2&e&&(c.Cb(1),c.Mc(t.title),c.Cb(1),c.Hb("metric","metric"===t.viewType),c.rc("duelitkeenname",t.keenName)("viewType",t.viewType)("queryType",t.queryType)("query",t.query)("title",t.subTitle)("ngClass",t.keenName)("isCombined",t.isCombined)("apiResult",t.apiResult))},directives:[A,i.l],styles:["[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]{height:250px;width:auto;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .duelit-keen-data.metric[_ngcontent-%COMP%]{height:unset}"]}),e})();var q=n("Jx61");function R(e,t){1&e&&c.Qb(0,"duelit-keen-api",10),2&e&&c.rc("keenApiInput",t.$implicit)}function V(e,t){if(1&e&&(c.Tb(0),c.Jc(1,R,1,1,"duelit-keen-api",9),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function J(e,t){if(1&e&&c.Qb(0,"duelit-keen",11),2&e){const e=t.$implicit,n=c.lc();c.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)("isCombined",e.isCombined)("apiResult",n.tournamentCountPerType$)}}function M(e,t){1&e&&c.Qb(0,"duelit-keen-api",13),2&e&&c.rc("keenApiInput",t.$implicit)}function D(e,t){if(1&e&&(c.Tb(0),c.Jc(1,M,1,1,"duelit-keen-api",12),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function F(e,t){1&e&&c.Qb(0,"duelit-keen-api",13),2&e&&c.rc("keenApiInput",t.$implicit)}function E(e,t){if(1&e&&(c.Tb(0),c.Jc(1,F,1,1,"duelit-keen-api",12),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function L(e,t){1&e&&c.Qb(0,"duelit-keen-api",13),2&e&&c.rc("keenApiInput",t.$implicit)}function Q(e,t){if(1&e&&(c.Tb(0),c.Jc(1,L,1,1,"duelit-keen-api",12),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function N(e,t){1&e&&c.Qb(0,"duelit-metric",15),2&e&&c.rc("metric",t.$implicit)}function B(e,t){if(1&e&&(c.Tb(0),c.Jc(1,N,1,1,"duelit-metric",14),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function H(e,t){if(1&e&&(c.Tb(0),c.Qb(1,"duelit-keen-api",16),c.Sb()),2&e){const e=c.lc();c.Cb(1),c.rc("keenApiInput",e.challengeRatioStats$)}}function G(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",18),c.hc("click",(function(){c.Cc(e);const n=t.$implicit;return c.lc(2).openUsersSignup(n)})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function z(e,t){if(1&e&&(c.Tb(0),c.Jc(1,G,1,1,"duelit-metric",17),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function Y(e,t){if(1&e&&(c.Tb(0),c.Qb(1,"duelit-keen-api",10),c.Sb()),2&e){const e=c.lc();c.Cb(1),c.rc("keenApiInput",e.signupRatioStats$)}}function K(e,t){if(1&e&&c.Qb(0,"duelit-keen",19),2&e){const e=t.$implicit;c.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)}}function X(e,t){if(1&e&&c.Qb(0,"duelit-keen",20),2&e){const e=t.$implicit;c.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)}}function W(e,t){1&e&&c.Qb(0,"duelit-keen-api",10),2&e&&c.rc("keenApiInput",t.$implicit)}function Z(e,t){if(1&e&&(c.Tb(0),c.Jc(1,W,1,1,"duelit-keen-api",9),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function ee(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",18),c.hc("click",(function(){return c.Cc(e),c.lc(2).openActiveUsers()})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function te(e,t){if(1&e&&(c.Tb(0),c.Jc(1,ee,1,1,"duelit-metric",17),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function ne(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",18),c.hc("click",(function(){return c.Cc(e),c.lc(2).openUsersByBanned()})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function ie(e,t){if(1&e&&(c.Tb(0),c.Jc(1,ne,1,1,"duelit-metric",17),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function ae(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",18),c.hc("click",(function(){c.Cc(e);const n=t.$implicit;return c.lc(2).openConvertedUsers(n.type)})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function se(e,t){if(1&e&&(c.Tb(0),c.Jc(1,ae,1,1,"duelit-metric",17),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function re(e,t){if(1&e&&(c.Tb(0),c.Qb(1,"duelit-keen-api",10),c.Sb()),2&e){const e=c.lc();c.Cb(1),c.rc("keenApiInput",e.txnOnInsufficientFundsRatio$)}}function ce(e,t){1&e&&(c.Vb(0,"div",21),c.Qb(1,"span",22),c.Ub())}const oe=h().subtract(6,"days").format(k.c),le=h().format(k.c);let ue=(()=>{class e{constructor(e,t,n,i){this.api=e,this.dashboardDate=t,this.router=n,this.numberPipe=i,this.gamesQueries=[{title:"Daily Games",keenname:"daily-games",viewType:"line",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.name",timeframe:{start:oe,end:le},interval:"daily",filters:[{property_name:"Game.name",operator:"ne",property_value:null}]}},{title:"Games Per Type",keenname:"games-per-type",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.type",timeframe:{start:oe,end:le}},isCombined:!0}],this.engagement1Queries=[{title:"Total Challenges",keenname:"challenges-total",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge created",timeframe:{start:oe,end:le}}},{title:"Accepted Challenges",keenname:"challenges-accepted",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge accepted",timeframe:{start:oe,end:le}}},{title:"Challenge Ratio",keenname:"challenge-ratio",viewType:"pie",queryType:"count",query:{eventCollection:["Challenge created","Challenge accepted"],timeframe:{start:oe,end:le}}}],this.engagement3Queries=[{title:"Total App Launched",keenname:"app-launced-total",viewType:"metric",queryType:"count",query:{eventCollection:"App launched",timeframe:{start:oe,end:le}}}],this.engagement4Queries=[{title:"Games Per OS",keenname:"games-per-os",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Device.OS",timeframe:{start:oe,end:le},filters:[{property_name:"Device.OS",operator:"exists",property_value:!0}]}}],this.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie"},this.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie"},this.txnOnInsufficientFundsRatio$={title:"Transaction on Insufficient Funds",classSelector:"txn-on-insufficient-funds-ratio",viewType:"pie"},this.ngUnsubscribe=new f.a,this.FAILED_TO_RETRIEVE="-"}ngOnInit(){this.rangeDate=new a.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(T.a)(this.ngUnsubscribe)).subscribe(e=>{this.dashboardDate.range=e}),this.date$=new y.a(this.dashboardDate.range),this.date$.pipe(Object(T.a)(this.ngUnsubscribe)).subscribe(({from:e,to:t})=>{const n=h().year(e.year).month(e.month-1).date(e.day).format(k.c),i=h().year(t.year).month(t.month-1).date(t.day).format(k.c);this.getRevenueStats(n,i),this.getSignupTypeStats(n,i),this.getSignupCountStats(n,i),this.getSignupRatioStats(),this.getActiveUsersStats(n,i),this.getChallengeStats(n,i),this.getTxnOnInsufficientFunds(n,i),this.getCreatedChallengePerHrStats(n,i),this.getCompletedChallengePerHrStats(n,i),this.getCompletedTournamentPerHrStats(n,i),this.getTournamentCountPerType(n,i),this.getChallengeRatioStats(),this.getTxnOnInsufficientFundsRatio(),this.getUserStats(n,i),this.updateQueries(this.engagement1Queries,n,i),this.updateQueries(this.engagement3Queries,n,i),this.updateQueries(this.engagement4Queries,n,i),this.updateQueries(this.gamesQueries,n,i)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.date$.complete()}getRevenueStats(e,t){this.revenueStats$=this.api.get(g.a.RevenueStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];let n=[];e.length&&(n=[{type:"Duelit",result:e.reduce((e,t)=>e+t.duelit_revenue,0)},{type:"Player",result:e.reduce((e,t)=>e+t.player_revenue,0)}]),t.push({title:"Revenue Generated",classSelector:"revenue1",viewType:"bar",data:n}),t.push({title:"Revenue Generated (Percentage)",classSelector:"revenue2",viewType:"pie",data:n});const i={title:"Revenue by Game (Duelit)",classSelector:"revenue3",viewType:"pie",data:e.map(e=>({type:e.game,result:e.duelit_revenue}))};return t.push(i),t}))}getSignupTypeStats(e,t){this.signupTypeStats$=this.api.get(g.e.SignupType,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];return"0"===e.facebook&&"0"===e.apple&&"0"===e.email||Object.keys(e).forEach(n=>{t.push({type:n.charAt(0).toUpperCase()+n.slice(1),result:e[n]})}),[{title:"Signup Type",classSelector:"signup-type",viewType:"pie",data:t}]}))}getSignupCountStats(e,t){this.signupCountStats$=this.api.get(g.e.SignupCount,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{name:k.b.SignupCount,title:"Total Sign Ups",subTitle:"Count - Sign up",data:this.numberPipe.transform(e.signups)},{name:k.b.ActivatedSignupCount,title:"Total Activated Sign Ups",subTitle:"Count - Sign up activated",data:this.numberPipe.transform(e.activated)}]))}getSignupRatioStats(){this.signupCountStats$.subscribe(e=>{let t=0;e[0].data&&e[1].data&&(t=e[0].data.replace(/,/g,"")-e[1].data.replace(/,/g,""));const n=[{type:"Activated",result:e[1].data?e[1].data.replace(/,/g,""):0},{type:"Pending",result:t}];this.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie",data:n}})}getActiveUsersStats(e,t){this.activeUsersStats$=this.api.get(g.e.ActiveUsersStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Active Users",subTitle:"Count - Active Users",data:e.active_users_count}]))}getChallengeStats(e,t){this.challengeStats$=this.api.get(g.d.ChallengeStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Cancelled",subTitle:"Cancelled Challenges",data:e.cancelled?this.numberPipe.transform(e.cancelled):0},{title:"Completed",subTitle:"Completed Challenges",data:e.completed?this.numberPipe.transform(e.completed):0},{title:"Sent",subTitle:"Total Sent Challenges",data:this.numberPipe.transform((parseInt(e.cancelled)||0)+(parseInt(e.completed)||0))}]))}getTxnOnInsufficientFunds(e,t){const n=this.api.buildPath(g.e.UsersByConverted,["converted"]);this.txnOnInsufficientFunds$=this.api.get(n,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(S.a)(n=>{const i=this.api.buildPath(g.e.UsersByConverted,["churned"]);return this.api.get(i,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Users Converted when Coins Ran Out",subTitle:"Count",type:"converted",data:n.totalCount?this.numberPipe.transform(n.totalCount):0},{title:"Users Churned when Coins Ran Out",subTitle:"Count",type:"churned",data:e.totalCount?this.numberPipe.transform(e.totalCount):0}]))}))}getCreatedChallengePerHrStats(e,t){this.createdChallengePerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Created Challenge",classSelector:"total-challenge-sent",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getCompletedChallengePerHrStats(e,t){this.completedChallengePerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{status:"Ended",start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Completed Challenge",classSelector:"total-challenge-Completed",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getCompletedTournamentPerHrStats(e,t){this.completedTournamentPerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{type:"open",status:"Ended",start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Completed Tournament",classSelector:"total-tournament-completed",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getTournamentCountPerType(e,t){this.tournamentCountPerType$=this.api.get(g.d.TournamentCountPerType,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)([])))}getChallengeRatioStats(){this.challengeStats$.subscribe(e=>{const t=[{type:"Cancelled",result:e[0].data?e[0].data.replace(/,/g,""):0},{type:"Completed",result:e[1].data?e[1].data.replace(/,/g,""):0}];this.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie",data:t}})}getTxnOnInsufficientFundsRatio(){this.txnOnInsufficientFunds$.subscribe(e=>{const t=[{type:"Converted",result:e[0].data?e[0].data.replace(/,/g,""):0},{type:"Churned",result:e[1].data?e[1].data.replace(/,/g,""):0}];this.txnOnInsufficientFundsRatio$={title:"Total User that Ran Out of Coins",classSelector:"transaction-ratio",viewType:"pie",data:t}})}getUserStats(e,t){const n=this.api.buildPath(g.e.UsersCountByStatus,["banned"]);this.userStats$=this.api.get(n,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(v.a)(e=>Object(C.a)(e.error.text||this.FAILED_TO_RETRIEVE)),Object(O.a)(e=>[{title:"Total Banned Users",subTitle:"Count - Banned Users",data:e}]))}updateQueries(e,t,n){let i;i=t===n&&t===h().format(k.c)?"this_1_days":{start:t,end:n},e.forEach(e=>{"string"!=typeof e.query.timeframe&&(e.query=Object.assign(Object.assign({},e.query),{timeframe:i}))})}updateDate(){this.date$.next(Object.assign({},this.dashboardDate.range))}isDateRangeValid(){const e=this.rangeDate.value;return e.from&&e.to}openUsersSignup(e){const{from:t,to:n}=this.date$.getValue(),i=Object(P.b)(t).format(k.c),a=Object(P.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{created_start_date:i,created_end_date:a,not_status:e.name===k.b.ActivatedSignupCount?"pending":""}})}openUsersByBanned(){const{from:e,to:t}=this.date$.getValue(),n=Object(P.b)(e).format(k.c),i=Object(P.b)(t).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{status:k.f.Banned,start_date:n,end_date:i}})}openUsersByTransaction(e){const{from:t,to:n}=this.date$.getValue(),i=Object(P.b)(t).format(k.c),a=Object(P.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{transaction:k.e.RedeemCoinsRequest,start_date:i,end_date:a}})}openActiveUsers(){const{from:e,to:t}=this.date$.getValue(),n=Object(P.b)(e).format(k.c),i=Object(P.b)(t).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{last_active_start_date:n,last_active_end_date:i}})}openConvertedUsers(e){const{from:t,to:n}=this.date$.getValue(),i=Object(P.b)(t).format(k.c),a=Object(P.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{convertedType:e,start_date:i,end_date:a}})}}return e.\u0275fac=function(t){return new(t||e)(c.Pb(w.a),c.Pb(I.a),c.Pb(m.b),c.Pb(i.f))},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-app-data"]],decls:55,vars:57,consts:[[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],[1,"row","container"],[4,"ngIf","ngIfElse"],["class","col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult",4,"ngFor","ngForOf"],["class","col metric",3,"title","keenName","viewType","queryType","query",4,"ngFor","ngForOf"],["class","col-6 metric",3,"title","keenName","viewType","queryType","query",4,"ngFor","ngForOf"],["loading",""],["class","col-4",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-4",3,"keenApiInput"],[1,"col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult"],["class","col-12",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-12",3,"keenApiInput"],["class","col-3 pointer",3,"metric",4,"ngFor","ngForOf"],[1,"col-3","pointer",3,"metric"],[1,"col-3",3,"keenApiInput"],["class","col-4 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-4","pointer",3,"metric","click"],[1,"col","metric",3,"title","keenName","viewType","queryType","query"],[1,"col-6","metric",3,"title","keenName","viewType","queryType","query"],[1,"col","col-loading"],[1,"metric","loading"]],template:function(e,t){if(1&e&&(c.Vb(0,"div",0),c.Qb(1,"duelit-date-picker-range",1),c.Vb(2,"button",2),c.hc("click",(function(){return t.updateDate()})),c.Lc(3,"Filter"),c.Ub(),c.Ub(),c.Vb(4,"div"),c.Vb(5,"h4"),c.Lc(6,"Revenue"),c.Ub(),c.Vb(7,"div",3),c.Jc(8,V,2,1,"ng-container",4),c.mc(9,"async"),c.Ub(),c.Vb(10,"h4"),c.Lc(11,"Games"),c.Ub(),c.Vb(12,"div",3),c.Jc(13,J,1,7,"duelit-keen",5),c.Ub(),c.Vb(14,"h4"),c.Lc(15,"Engagement"),c.Ub(),c.Vb(16,"div",3),c.Jc(17,D,2,1,"ng-container",4),c.mc(18,"async"),c.Ub(),c.Vb(19,"div",3),c.Jc(20,E,2,1,"ng-container",4),c.mc(21,"async"),c.Ub(),c.Vb(22,"div",3),c.Jc(23,Q,2,1,"ng-container",4),c.mc(24,"async"),c.Ub(),c.Vb(25,"div",3),c.Jc(26,B,2,1,"ng-container",4),c.mc(27,"async"),c.Jc(28,H,2,1,"ng-container",4),c.mc(29,"async"),c.Ub(),c.Vb(30,"div",3),c.Jc(31,z,2,1,"ng-container",4),c.mc(32,"async"),c.Jc(33,Y,2,1,"ng-container",4),c.mc(34,"async"),c.Ub(),c.Vb(35,"div",3),c.Jc(36,K,1,5,"duelit-keen",6),c.Ub(),c.Vb(37,"div",3),c.Jc(38,X,1,5,"duelit-keen",7),c.Ub(),c.Vb(39,"h4"),c.Lc(40,"User Statistics"),c.Ub(),c.Vb(41,"div",3),c.Jc(42,Z,2,1,"ng-container",4),c.mc(43,"async"),c.Jc(44,te,2,1,"ng-container",4),c.mc(45,"async"),c.Jc(46,ie,2,1,"ng-container",4),c.mc(47,"async"),c.Ub(),c.Vb(48,"div",3),c.Jc(49,se,2,1,"ng-container",4),c.mc(50,"async"),c.Jc(51,re,2,1,"ng-container",4),c.mc(52,"async"),c.Ub(),c.Ub(),c.Jc(53,ce,2,0,"ng-template",null,8,c.Kc)),2&e){const e=c.zc(54);c.Cb(1),c.rc("formControl",t.rangeDate),c.Cb(1),c.rc("disabled",!t.isDateRangeValid()),c.Cb(6),c.rc("ngIf",c.nc(9,31,t.revenueStats$))("ngIfElse",e),c.Cb(5),c.rc("ngForOf",t.gamesQueries),c.Cb(4),c.rc("ngIf",c.nc(18,33,t.createdChallengePerHrStats$))("ngIfElse",e),c.Cb(3),c.rc("ngIf",c.nc(21,35,t.completedChallengePerHrStats$))("ngIfElse",e),c.Cb(3),c.rc("ngIf",c.nc(24,37,t.completedTournamentPerHrStats$))("ngIfElse",e),c.Cb(3),c.rc("ngIf",c.nc(27,39,t.challengeStats$))("ngIfElse",e),c.Cb(2),c.rc("ngIf",c.nc(29,41,t.challengeStats$))("ngIfElse",e),c.Cb(3),c.rc("ngIf",c.nc(32,43,t.signupCountStats$))("ngIfElse",e),c.Cb(2),c.rc("ngIf",c.nc(34,45,t.signupCountStats$))("ngIfElse",e),c.Cb(3),c.rc("ngForOf",t.engagement3Queries),c.Cb(2),c.rc("ngForOf",t.engagement4Queries),c.Cb(4),c.rc("ngIf",c.nc(43,47,t.signupTypeStats$))("ngIfElse",e),c.Cb(2),c.rc("ngIf",c.nc(45,49,t.activeUsersStats$))("ngIfElse",e),c.Cb(2),c.rc("ngIf",c.nc(47,51,t.userStats$))("ngIfElse",e),c.Cb(3),c.rc("ngIf",c.nc(50,53,t.txnOnInsufficientFunds$))("ngIfElse",e),c.Cb(2),c.rc("ngIf",c.nc(52,55,t.txnOnInsufficientFunds$))("ngIfElse",e)}},directives:[_.a,a.l,a.e,i.n,i.m,U.a,j,q.a],pipes:[i.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}"]}),e})();var pe=n("Olgc");function be(e,t){1&e&&c.Qb(0,"duelit-metric",8),2&e&&c.rc("metric",t.$implicit)}function de(e,t){if(1&e&&(c.Tb(0),c.Jc(1,be,1,1,"duelit-metric",7),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function me(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",10),c.hc("click",(function(){c.Cc(e);const n=t.$implicit;return c.lc(2).openUsersByTransaction(n)})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function ge(e,t){if(1&e&&(c.Tb(0),c.Jc(1,me,1,1,"duelit-metric",9),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function he(e,t){1&e&&(c.Vb(0,"div",11),c.Qb(1,"span",12),c.Ub())}function fe(e,t){if(1&e){const e=c.Wb();c.Vb(0,"duelit-metric",14),c.hc("click",(function(){c.Cc(e);const n=t.$implicit;return c.lc(2).openUsersByTransaction(n)})),c.Ub()}2&e&&c.rc("metric",t.$implicit)}function ye(e,t){if(1&e&&(c.Tb(0),c.Jc(1,fe,1,1,"duelit-metric",13),c.Sb()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function Ce(e,t){if(1&e&&(c.Tb(0),c.Qb(1,"duelit-metric",15),c.Sb()),2&e){const e=c.lc();c.Cb(1),c.rc("metric",e.totalProfitStats$)}}let Te=(()=>{class e{constructor(e,t,n,i,a,s){this.api=e,this.dashboardDate=t,this.toast=n,this.router=i,this.numberPipe=a,this.currencyPipe=s,this.ngUnsubscribe=new f.a}ngOnInit(){this.rangeDate=new a.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(T.a)(this.ngUnsubscribe)).subscribe(e=>{this.dashboardDate.range=e}),this.date$=new y.a(this.dashboardDate.range),this.totalCredits$=this.api.get(g.c.TotalCredits).pipe(Object(v.a)(e=>Object(C.a)({totalCoins:0,giftedCoins:0})),Object(O.a)(e=>[{title:"Total Coins",subTitle:"Count - Total In-game Coins",data:e.totalCoins?this.numberPipe.transform(e.totalCoins):"0"},{title:"Total Gifted Coins",subTitle:"Count - Total Gifted Coins",data:e.giftedCoins?this.numberPipe.transform(e.giftedCoins):"0"}])),this.date$.subscribe(({from:e,to:t})=>{const n=Object(P.b)(e).format(k.c),i=Object(P.b)(t).format(k.c);this.getRedeemedStats(n,i),this.getTotalProfitStats(),this.productsSold$=this.api.get(g.c.PurchasedCoins,{query:{start_date:n,end_date:i}}).pipe(Object(v.a)(e=>(this.toast.error(e.error||e.statusText||e.message),Object(C.a)([{amount:"0.01",count:0},{amount:"4.99",count:0},{amount:"9.99",count:0},{amount:"25.99",count:0},{amount:"49.99",count:0}]))),Object(O.a)(e=>e.map(e=>({name:k.b.PurchasedCount,title:null,subTitle:`Count - Total ${"0.01"===e.amount?"Watched Ads ($0.01)":`Purchased $${e.amount}`}`,data:e.count,amount:Number(e.amount)}))))})}updateDate(){this.date$.next(Object.assign({},this.dashboardDate.range))}isDateRangeValid(){const e=this.rangeDate.value;return e.from&&e.to}getRedeemedStats(e,t){this.redeemedStats$=this.api.get(g.c.RedeemedCoins,{query:{start_date:e,end_date:t}}).pipe(Object(v.a)(e=>Object(C.a)({totalAmount:k.d,playerCount:k.d})),Object(O.a)(e=>{let t,n;try{t=parseInt(e.totalAmount),n=Math.floor(.00825*t*100)/100}catch(a){console.log("Invalid coin amount",a)}let i="$0<br>0 coins";return n&&t&&(i=`${this.currencyPipe.transform(n)}<br>${this.numberPipe.transform(t)} coins`),[{name:k.b.RedeemCount,title:"Total Redeems",subTitle:"Redeem Stats",data:i,class:"coin-dollar-metric",amount:n},{name:k.b.RedeemCount,title:"Redeemed Players Count",subTitle:"Count - Players Count",data:e.playerCount}]}))}getTotalProfitStats(){let e;this.redeemedStats$.pipe(Object(S.a)(t=>(e=t[0].amount,this.productsSold$))).subscribe(t=>{const n=t.reduce((e,t)=>e+t.amount*Number(t.data),0)-e;let i="$0<br>0 coins";n&&(i=`${this.currencyPipe.transform(n)}<br>${this.numberPipe.transform(Math.floor(n/.00825))} coins`),this.totalProfitStats$={title:"Total Profit",subTitle:"Total Profit Stats",data:i,class:"coin-dollar-metric"}})}openUsersByTransaction(e){const{from:t,to:n}=this.date$.getValue(),i=Object(P.b)(t).format(k.c),a=Object(P.b)(n).format(k.c),s={transaction:k.e.RedeemCoinsRequest,start_date:i,end_date:a};e.name===k.b.PurchasedCount&&(s.transaction=k.e.Transaction,s.amount=e.amount),this.router.navigate(["/admin/users"],{queryParams:s})}}return e.\u0275fac=function(t){return new(t||e)(c.Pb(w.a),c.Pb(I.a),c.Pb(pe.a),c.Pb(m.b),c.Pb(i.f),c.Pb(i.d))},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-finance"]],decls:27,vars:18,consts:[[1,"row","container"],[4,"ngIf","ngIfElse"],[1,"divider"],[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],["loading",""],["class","col-6",3,"metric",4,"ngFor","ngForOf"],[1,"col-6",3,"metric"],["class","col-2 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-2","pointer",3,"metric","click"],[1,"col","col-loading"],[1,"metric","loading"],["class","col-6 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-6","pointer",3,"metric","click"],[1,"col-12",3,"metric"]],template:function(e,t){if(1&e&&(c.Vb(0,"h4"),c.Lc(1,"Coins"),c.Ub(),c.Vb(2,"div",0),c.Jc(3,de,2,1,"ng-container",1),c.mc(4,"async"),c.Ub(),c.Qb(5,"div",2),c.Vb(6,"div",3),c.Qb(7,"duelit-date-picker-range",4),c.Vb(8,"button",5),c.hc("click",(function(){return t.updateDate()})),c.Lc(9,"Filter"),c.Ub(),c.Ub(),c.Vb(10,"h4"),c.Lc(11,"Purchased Product"),c.Ub(),c.Vb(12,"div",0),c.Jc(13,ge,2,1,"ng-container",1),c.mc(14,"async"),c.Ub(),c.Jc(15,he,2,0,"ng-template",null,6,c.Kc),c.Vb(17,"h4"),c.Lc(18,"Redeemed Coins"),c.Ub(),c.Vb(19,"div",0),c.Jc(20,ye,2,1,"ng-container",1),c.mc(21,"async"),c.Ub(),c.Vb(22,"h4"),c.Lc(23,"Total Profit"),c.Ub(),c.Vb(24,"div",0),c.Jc(25,Ce,2,1,"ng-container",1),c.mc(26,"async"),c.Ub()),2&e){const e=c.zc(16);c.Cb(3),c.rc("ngIf",c.nc(4,10,t.totalCredits$))("ngIfElse",e),c.Cb(4),c.rc("formControl",t.rangeDate),c.Cb(1),c.rc("disabled",!t.isDateRangeValid()),c.Cb(5),c.rc("ngIf",c.nc(14,12,t.productsSold$))("ngIfElse",e),c.Cb(7),c.rc("ngIf",c.nc(21,14,t.redeemedStats$))("ngIfElse",e),c.Cb(5),c.rc("ngIf",c.nc(26,16,t.redeemedStats$))("ngIfElse",e)}},directives:[i.n,_.a,a.l,a.e,i.m,q.a],pipes:[i.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}",".divider[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:20px}"]}),e})();var ve=n("PqYM"),Oe=n("l7GE"),Se=n("ZUHj");class ke{constructor(e){this.notifier=e}call(e,t){return t.subscribe(new Pe(e,this.notifier,t))}}class Pe extends Oe.a{constructor(e,t,n){super(e),this.notifier=t,this.source=n,this.sourceIsBeingSubscribedTo=!0}notifyNext(e,t,n,i,a){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)}notifyComplete(e){if(!1===this.sourceIsBeingSubscribedTo)return super.complete()}complete(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return super.complete();this._unsubscribeAndRecycle(),this.notifications.next()}}_unsubscribe(){const{notifications:e,retriesSubscription:t}=this;e&&(e.unsubscribe(),this.notifications=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null}_unsubscribeAndRecycle(){const{_unsubscribe:e}=this;return this._unsubscribe=null,super._unsubscribeAndRecycle(),this._unsubscribe=e,this}subscribeToRetries(){let e;this.notifications=new f.a;try{const{notifier:t}=this;e=t(this.notifications)}catch(t){return super.complete()}this.retries=e,this.retriesSubscription=Object(Se.a)(this,e)}}var we=n("bOdf");const Ie={asc:"desc",desc:"","":"asc"};let _e=(()=>{class e{constructor(){this.duelitSortable="",this.direction="",this.tableName="",this.sort=new c.o}get _t(){return!0}get isAscending(){return"asc"===this.direction}get isDescending(){return"desc"===this.direction}rotate(){this.direction=Ie[this.direction],this.sort.emit({column:this.duelitSortable,direction:this.direction})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=c.Kb({type:e,selectors:[["th","duelitSortable",""]],hostVars:6,hostBindings:function(e,t){1&e&&c.hc("click",(function(e){return t.rotate(e)})),2&e&&c.Hb("pointer",t._t)("asc",t.isAscending)("desc",t.isDescending)},inputs:{duelitSortable:"duelitSortable",direction:"direction",tableName:"tableName"},outputs:{sort:"sort"}}),e})();function Ue(e,t){if(1&e){const e=c.Wb();c.Vb(0,"th",5),c.hc("sort",(function(t){return c.Cc(e),c.lc(2).onSort(t)})),c.Lc(1),c.Ub()}if(2&e){const e=t.$implicit;c.rc("duelitSortable",e),c.Cb(1),c.Mc(e.name)}}function xe(e,t){if(1&e&&(c.Vb(0,"th",8),c.Lc(1),c.Ub()),2&e){const e=c.lc().$implicit;c.Cb(1),c.Mc(e)}}function $e(e,t){if(1&e&&(c.Vb(0,"td"),c.Lc(1),c.Ub()),2&e){const e=c.lc().$implicit;c.Cb(1),c.Mc(e)}}function Ae(e,t){if(1&e&&(c.Tb(0),c.Jc(1,xe,2,1,"th",6),c.Jc(2,$e,2,1,"ng-template",null,7,c.Kc),c.Sb()),2&e){const e=t.index,n=c.zc(3);c.Cb(1),c.rc("ngIf",0===e)("ngIfElse",n)}}function je(e,t){if(1&e&&(c.Vb(0,"tr"),c.Jc(1,Ae,4,2,"ng-container",4),c.Ub()),2&e){const e=t.$implicit;c.Cb(1),c.rc("ngForOf",e)}}function qe(e,t){if(1&e&&(c.Vb(0,"table",2),c.Vb(1,"thead"),c.Vb(2,"tr"),c.Jc(3,Ue,2,2,"th",3),c.Ub(),c.Ub(),c.Vb(4,"tbody"),c.Jc(5,je,2,1,"tr",4),c.Ub(),c.Ub()),2&e){const e=c.lc();c.Cb(3),c.rc("ngForOf",e.headerMapping),c.Cb(2),c.rc("ngForOf",e.tableData)}}function Re(e,t){1&e&&c.Lc(0," No data to show.\n")}let Ve=(()=>{class e{constructor(){this.headerMapping=[],this.data=[],this.sort=new c.o,this.sortDirection=""}ngOnInit(){}getData(e,t){let n=t;return e.split(".").forEach(e=>n=n[e]),String(n)}get tableData(){return this.data.map(e=>this.headerMapping.map(t=>this.getData(t.path,e))).sort((e,t)=>{let n=this.headerMapping.indexOf(this.sortColumn);n<0&&(n=0);const i=(a=e[n])<(s=t[n])?-1:a>s?1:0;var a,s;return"desc"===this.sortDirection?-1*i:i})}onSort({column:e,direction:t}){this.headers.forEach(t=>{t.duelitSortable!==e&&(t.direction="")}),this.sortColumn=e,this.sortDirection=t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-table"]],viewQuery:function(e,t){var n;1&e&&c.Qc(_e,!0),2&e&&c.yc(n=c.ic())&&(t.headers=n)},inputs:{headerMapping:"headerMapping",data:"data",tableName:"tableName"},outputs:{sort:"sort"},decls:3,vars:2,consts:[["class","table table-striped",4,"ngIf","ngIfElse"],["noData",""],[1,"table","table-striped"],["scope","col",3,"duelitSortable","sort",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["scope","col",3,"duelitSortable","sort"],["scope","row",4,"ngIf","ngIfElse"],["td",""],["scope","row"]],template:function(e,t){if(1&e&&(c.Jc(0,qe,6,2,"table",0),c.Jc(1,Re,1,0,"ng-template",null,1,c.Kc)),2&e){const e=c.zc(2);c.rc("ngIf",t.data.length)("ngIfElse",e)}},directives:[i.n,i.m,_e],styles:['th.asc[_ngcontent-%COMP%]:before, th.desc[_ngcontent-%COMP%]:before{content:"";display:block;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAmxJREFUeAHtmksrRVEUx72fH8CIGQNJkpGUUmakDEiZSJRIZsRQmCkTJRmZmJgQE0kpX0D5DJKJgff7v+ru2u3O3vvc67TOvsdatdrnnP1Y///v7HvvubdbUiIhBISAEBACQkAICAEhIAQ4CXSh2DnyDfmCPEG2Iv9F9MPlM/LHyAecdyMzHYNwR3fdNK/OH9HXl1UCozD24TCvILxizEDWIEzA0FcM8woCgRrJCoS5PIwrANQSMAJX1LEI9bqpQo4JYNFFKRSvIgsxHDVnqZgIkPnNBM0rIGtYk9YOOsqgbgepRCfdbmFtqhFkVEDVPjJp0+Z6e6hRHhqBKgg6ZDCvYBygVmUoEGoh5JTRvIJwhJo1aUOoh4CLPMyvxxi7EWOMgnCGsXXI1GIXlZUYX7ucU+kbR8NW8lh3O7cue0Pk32MKndfUxQFAwxdirk3fHappAnc0oqDPzDfGTBrCfHP04dM4oTV8cxr0SVzH9FF07xD3ib6xCDE+M+aUcVygtWzzbtGX2rPBrEUYfecfQkaFzYi6HjVnGBdtL7epqAlc1+jRdAap74RrnPc4BCijttY2tRcdN0g17w7HqZrXhdJTYAuS3hd8z+vKgK3V1zWPae0mZDMykadBn1hTQBLnZNwVrJpSe/NwEeDsEwCctEOsJTsgxLvCqUl2ACftEGvJDgjxrnBqkh3ASTvEWrIDQrwrnJpkB3DSDrGW7IAQ7wqnJtkBnLRztejXXVu4+mxz/nQ9jR1w5VB86ejLTFcnnDwhzV+F6T+CHZlx6THSjn76eyyBIOPHyDakhBAQAkJACAgBISAEhIAQYCLwC8JxpAmsEGt6AAAAAElFTkSuQmCC") no-repeat;background-size:auto;background-size:22px;width:22px;height:22px;float:left;margin-left:-22px}th.desc[_ngcontent-%COMP%]:before{-webkit-transform:rotate(180deg);transform:rotate(180deg);-ms-transform:rotate(180deg)}']}),e})();function Je(e,t){1&e&&(c.Vb(0,"div",3),c.Qb(1,"span",4),c.Ub())}function Me(e,t){if(1&e&&(c.Tb(0),c.Qb(1,"duelit-table",5),c.Sb()),2&e){const e=t.$implicit,n=c.lc();c.Cb(1),c.rc("data",e)("headerMapping",n.tableHeadersMapping)}}let De=(()=>{class e{constructor(e){this.api=e,this.ngUnsubscribe=new f.a,this.POLL_INTERVAL=1e4,this.timer$=new y.a(this.POLL_INTERVAL/1e3),this._stop=new f.a,this._start=new f.a,this.tableHeadersMapping=[{name:"ID",path:"tournament_id"},{name:"Game Name",path:"game_name"},{name:"Joined Players",path:"total_players"},{name:"Real Players",path:"total_real_players"},{name:"Minimum Players",path:"minimum_players"},{name:"Status",path:"status"},{name:"Total Payout",path:"total_payout"},{name:"Level",path:"level"},{name:"Time Left",path:"time_left"}]}ngOnInit(){var e;Object(ve.a)(0,1e3).pipe(Object(O.a)(e=>this.POLL_INTERVAL/1e3-e),Object(T.a)(this._stop),(e=()=>this._start,t=>t.lift(new ke(e)))).subscribe(e=>{this.timer$.next(e)}),this.openTournaments$=Object(ve.a)(0,this.POLL_INTERVAL).pipe(Object(we.a)(()=>this.api.get(g.d.GetOccupiedOpenTournaments).pipe(Object(v.a)(e=>Object(C.a)({})))),Object(O.a)((e={})=>{null===e&&(e={}),this.restartTimer();let t=this.getTournamentListByStatus(e,"Started");return t=this.mapTimeLeft(t),t}),Object(T.a)(this.ngUnsubscribe))}getTournamentListByStatus(e,t){return Object.keys(e).filter(n=>e[n].status===t).map(t=>e[t])}mapTimeLeft(e){const t=h();return e.filter(e=>{const n=h.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss");return 0===t.diff(n,"hours")}).map(e=>{const n=h.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss"),i=h.duration(t.diff(n)),a=10-i.minutes(),s=60-i.seconds();return e.time_left="",a>0&&(e.time_left+=`${a} mins `),e.time_left+=`${s} secs`,e})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}restartTimer(){this._stop.next(),this._start.next()}}return e.\u0275fac=function(t){return new(t||e)(c.Pb(w.a))},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-realtime"]],decls:9,vars:7,consts:[["loading",""],[1,"d-inline","pr-1"],[4,"ngIf","ngIfElse"],[1,"col","col-loading"],[1,"metric","loading"],[3,"data","headerMapping"]],template:function(e,t){if(1&e&&(c.Jc(0,Je,2,0,"ng-template",null,0,c.Kc),c.Vb(2,"h4",1),c.Lc(3,"Active Tournaments"),c.Ub(),c.Vb(4,"span"),c.Lc(5),c.mc(6,"async"),c.Ub(),c.Jc(7,Me,2,2,"ng-container",2),c.mc(8,"async")),2&e){const e=c.zc(1);c.Cb(5),c.Nc("(Refreshing in ",c.nc(6,3,t.timer$)," seconds)"),c.Cb(2),c.rc("ngIf",c.nc(8,5,t.openTournaments$))("ngIfElse",e)}},directives:[i.n,Ve],pipes:[i.b],styles:[".col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}"]}),e})();function Fe(e,t){1&e&&c.Qb(0,"duelit-app-data")}function Ee(e,t){1&e&&c.Qb(0,"duelit-finance")}function Le(e,t){1&e&&c.Qb(0,"duelit-realtime")}const Qe=[{path:"",component:(()=>{class e{constructor(){this.activeTab="Application Data"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Jb({type:e,selectors:[["duelit-dashboard"]],decls:18,vars:2,consts:[["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],["ngbNavItem","Application Data"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","Finance"],["ngbNavItem","Realtime Data"],[1,"timezone"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(e,t){if(1&e&&(c.Vb(0,"ul",0,1),c.hc("activeIdChange",(function(e){return t.activeTab=e})),c.Vb(2,"li",2),c.Vb(3,"a",3),c.Lc(4,"App"),c.Ub(),c.Jc(5,Fe,1,0,"ng-template",4),c.Ub(),c.Vb(6,"li",5),c.Vb(7,"a",3),c.Lc(8,"Finance"),c.Ub(),c.Jc(9,Ee,1,0,"ng-template",4),c.Ub(),c.Vb(10,"li",6),c.Vb(11,"a",3),c.Lc(12,"Realtime"),c.Ub(),c.Jc(13,Le,1,0,"ng-template",4),c.Ub(),c.Vb(14,"li",7),c.Vb(15,"span"),c.Lc(16,"Timezone: UTC"),c.Ub(),c.Ub(),c.Ub(),c.Qb(17,"div",8)),2&e){const e=c.zc(1);c.rc("activeId",t.activeTab),c.Cb(17),c.rc("ngbNavOutlet",e)}},directives:[s.o,s.q,s.r,s.p,s.t,ue,Te,De],styles:[".timezone[_ngcontent-%COMP%]{display:-webkit-box;display:flex;float:right;-webkit-box-flex:1;flex-grow:1;-webkit-box-pack:right;justify-content:right;-webkit-box-align:center;align-items:center;padding-right:1em}"]}),e})()}];let Ne=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},imports:[[m.e.forChild(Qe)],m.e]}),e})();n.d(t,"DashboardModule",(function(){return Be}));let Be=(()=>{class e{}return e.\u0275mod=c.Nb({type:e}),e.\u0275inj=c.Mb({factory:function(t){return new(t||e)},providers:[i.f,i.d],imports:[[i.c,Ne,s.s,r.a,a.q,u,p,b.a,d.a,l]]}),e})()}}]);