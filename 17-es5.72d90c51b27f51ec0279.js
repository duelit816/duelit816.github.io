function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=_superPropBase(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{XRCK:function(e,t,n){"use strict";n.r(t);var i,a,r,c,s,o,u=n("ofXK"),l=n("3Pt+"),p=n("1kSV"),b=n("ftNi"),d=n("fXoL"),f=((c=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:c}),c.\u0275inj=d.Mb({factory:function(e){return new(e||c)},imports:[[u.c]]}),c),g=((r=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:r}),r.\u0275inj=d.Mb({factory:function(e){return new(e||r)},imports:[[u.c,f]]}),r),m=((a=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:a}),a.\u0275inj=d.Mb({factory:function(e){return new(e||a)},imports:[[u.c]]}),a),h=((i=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:i}),i.\u0275inj=d.Mb({factory:function(e){return new(e||i)},imports:[[u.c,m]]}),i),y=n("S48G"),v=n("geAU"),C=n("tyNb"),k=n("Znnd"),O=n("wd/R"),T=n("XNiG"),_=n("2Vo4"),S=n("LRne"),P=n("1G5W"),w=n("JIr8"),I=n("lJxs"),U=n("SLWe"),A=n("YGOX"),j=n("qc5V"),x=n("aVeI"),q=n("lbBO"),R=n("BamM"),$=n("J+vq"),V=n("h7dw"),M=((o=function(){function e(t,n,i){_classCallCheck(this,e),this.el=t,this.renderer=n,this.keen=i,this.viewInit=!1,this.loading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.el.nativeElement,"duelit-keen-data")}},{key:"ngOnChanges",value:function(){this.query&&this.viewInit&&(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.doQuery())}},{key:"doQuery",value:function(){var e=this;if(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.chart=new $.Dataviz({container:".".concat(this.duelitkeenname),title:"metric"===this.viewType&&this.title,type:this.viewType,legend:{pagination:{limit:10}},labelMapping:{Regular:"Challenge",Open:"Tournament","Practice game":"Practice"}}),this.query.eventCollection instanceof Array){var t=[];this.query.eventCollection.forEach((function(n){t.push(e.keen.query(e.queryType,{eventCollection:n,timeframe:e.query.timeframe,timezone:"UTC"}))})),this.keen.run(t).then((function(t){var n=[];n.push({type:"Accepted",result:t[1].result},{type:"Rejected",result:t[0].result-t[1].result}),e.chart.render({query:{timeframe:e.query.timeframe,timezone:"UTC"},result:n})}))}else this.loading=!0,this.keen.query(this.queryType,this.query).then((function(t){setTimeout((function(){e.isCombined&&e.apiResult?(t.result=[t.result.find((function(e){return"Practice game"===e["Game.type"]}))],e.apiResult.subscribe((function(n){n.forEach((function(e){t.result.push({"Game.type":e.type,result:e.count})})),e.chart.render(t)}))):e.chart.render(t)})),e.loading=!1})).catch((function(t){setTimeout((function(){e.chart.message(t.message)})),e.loading=!1}))}},{key:"ngAfterViewInit",value:function(){this.viewInit=!0,this.doQuery()}}]),e}()).\u0275fac=function(e){return new(e||o)(d.Pb(d.l),d.Pb(d.F),d.Pb(V.a))},o.\u0275dir=d.Kb({type:o,selectors:[["","duelitKeenData",""]],inputs:{duelitkeenname:"duelitkeenname",viewType:"viewType",queryType:"queryType",query:"query",title:"title",isCombined:"isCombined",apiResult:"apiResult"},features:[d.Ab()]}),o),D=((s=function(){function e(){_classCallCheck(this,e),this.loading=!0,this.viewInit=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||s)},s.\u0275cmp=d.Jb({type:s,selectors:[["duelit-keen"]],inputs:{title:"title",keenName:"keenName",viewType:"viewType",queryType:"queryType",query:"query",subTitle:"subTitle",isCombined:"isCombined",apiResult:"apiResult"},decls:3,vars:11,consts:[["duelitKeenData","",1,"duelit-keen-data",3,"duelitkeenname","viewType","queryType","query","title","ngClass","isCombined","apiResult"]],template:function(e,t){1&e&&(d.Vb(0,"h6"),d.Lc(1),d.Ub(),d.Qb(2,"div",0)),2&e&&(d.Cb(1),d.Mc(t.title),d.Cb(1),d.Hb("metric","metric"===t.viewType),d.rc("duelitkeenname",t.keenName)("viewType",t.viewType)("queryType",t.queryType)("query",t.query)("title",t.subTitle)("ngClass",t.keenName)("isCombined",t.isCombined)("apiResult",t.apiResult))},directives:[M,u.l],styles:["[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]{height:250px;width:auto;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .duelit-keen-data.metric[_ngcontent-%COMP%]{height:unset}"]}),s),J=n("Jx61");function E(e,t){1&e&&d.Qb(0,"duelit-keen-api",11),2&e&&d.rc("keenApiInput",t.$implicit)}function Q(e,t){if(1&e&&(d.Tb(0),d.Jc(1,E,1,1,"duelit-keen-api",10),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function F(e,t){if(1&e&&d.Qb(0,"duelit-keen",12),2&e){var n=t.$implicit,i=d.lc();d.rc("title",n.title)("keenName",n.keenname)("viewType",n.viewType)("queryType",n.queryType)("query",n.query)("isCombined",n.isCombined)("apiResult",i.tournamentCountPerType$)}}function L(e,t){1&e&&d.Qb(0,"duelit-keen-api",14),2&e&&d.rc("keenApiInput",t.$implicit)}function N(e,t){if(1&e&&(d.Tb(0),d.Jc(1,L,1,1,"duelit-keen-api",13),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function B(e,t){1&e&&d.Qb(0,"duelit-keen-api",14),2&e&&d.rc("keenApiInput",t.$implicit)}function G(e,t){if(1&e&&(d.Tb(0),d.Jc(1,B,1,1,"duelit-keen-api",13),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function H(e,t){1&e&&d.Qb(0,"duelit-metric",16),2&e&&d.rc("metric",t.$implicit)}function z(e,t){if(1&e&&(d.Tb(0),d.Jc(1,H,1,1,"duelit-metric",15),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function Y(e,t){if(1&e&&(d.Tb(0),d.Qb(1,"duelit-keen-api",11),d.Sb()),2&e){var n=d.lc();d.Cb(1),d.rc("keenApiInput",n.challengeRatioStats$)}}function K(e,t){if(1&e){var n=d.Wb();d.Vb(0,"duelit-metric",18),d.hc("click",(function(){d.Cc(n);var e=t.$implicit;return d.lc(2).openUsersSignup(e)})),d.Ub()}2&e&&d.rc("metric",t.$implicit)}function X(e,t){if(1&e&&(d.Tb(0),d.Jc(1,K,1,1,"duelit-metric",17),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function W(e,t){if(1&e&&(d.Tb(0),d.Qb(1,"duelit-keen-api",11),d.Sb()),2&e){var n=d.lc();d.Cb(1),d.rc("keenApiInput",n.signupRatioStats$)}}function Z(e,t){if(1&e&&d.Qb(0,"duelit-keen",19),2&e){var n=t.$implicit;d.rc("title",n.title)("keenName",n.keenname)("viewType",n.viewType)("queryType",n.queryType)("query",n.query)}}function ee(e,t){if(1&e&&d.Qb(0,"duelit-keen",20),2&e){var n=t.$implicit;d.rc("title",n.title)("keenName",n.keenname)("viewType",n.viewType)("queryType",n.queryType)("query",n.query)}}function te(e,t){1&e&&d.Qb(0,"duelit-keen-api",11),2&e&&d.rc("keenApiInput",t.$implicit)}function ne(e,t){if(1&e&&(d.Tb(0),d.Jc(1,te,1,1,"duelit-keen-api",10),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function ie(e,t){if(1&e){var n=d.Wb();d.Vb(0,"duelit-metric",18),d.hc("click",(function(){return d.Cc(n),d.lc(2).openActiveUsers()})),d.Ub()}2&e&&d.rc("metric",t.$implicit)}function ae(e,t){if(1&e&&(d.Tb(0),d.Jc(1,ie,1,1,"duelit-metric",17),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function re(e,t){if(1&e){var n=d.Wb();d.Vb(0,"duelit-metric",18),d.hc("click",(function(){return d.Cc(n),d.lc(2).openUsersByBanned()})),d.Ub()}2&e&&d.rc("metric",t.$implicit)}function ce(e,t){if(1&e&&(d.Tb(0),d.Jc(1,re,1,1,"duelit-metric",17),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function se(e,t){1&e&&(d.Vb(0,"div",21),d.Qb(1,"span",22),d.Ub())}var oe,ue=O().subtract(6,"days").format(U.c),le=O().format(U.c),pe=((oe=function(){function e(t,n,i,a){_classCallCheck(this,e),this.api=t,this.dashboardDate=n,this.router=i,this.numberPipe=a,this.gamesQueries=[{title:"Daily Games",keenname:"daily-games",viewType:"line",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.name",timeframe:{start:ue,end:le},interval:"daily",filters:[{property_name:"Game.name",operator:"ne",property_value:null}]}},{title:"Games Per Type",keenname:"games-per-type",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.type",timeframe:{start:ue,end:le}},isCombined:!0}],this.engagement1Queries=[{title:"Total Challenges",keenname:"challenges-total",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge created",timeframe:{start:ue,end:le}}},{title:"Accepted Challenges",keenname:"challenges-accepted",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge accepted",timeframe:{start:ue,end:le}}},{title:"Challenge Ratio",keenname:"challenge-ratio",viewType:"pie",queryType:"count",query:{eventCollection:["Challenge created","Challenge accepted"],timeframe:{start:ue,end:le}}}],this.engagement3Queries=[{title:"Total App Launched",keenname:"app-launced-total",viewType:"metric",queryType:"count",query:{eventCollection:"App launched",timeframe:{start:ue,end:le}}}],this.engagement4Queries=[{title:"Games Per OS",keenname:"games-per-os",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Device.OS",timeframe:{start:ue,end:le},filters:[{property_name:"Device.OS",operator:"exists",property_value:!0}]}}],this.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie"},this.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie"},this.ngUnsubscribe=new T.a,this.FAILED_TO_RETRIEVE="-"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.rangeDate=new l.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe((function(t){e.dashboardDate.range=t})),this.date$=new _.a(this.dashboardDate.range),this.date$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.from,i=t.to,a=O().year(n.year).month(n.month-1).date(n.day).format(U.c),r=O().year(i.year).month(i.month-1).date(i.day).format(U.c);e.getRevenueStats(a,r),e.getSignupTypeStats(a,r),e.getSignupCountStats(a,r),e.getSignupRatioStats(),e.getActiveUsersStats(a,r),e.getChallengeStats(a,r),e.getCreatedChallengePerHrStats(a,r),e.getCompletedChallengePerHrStats(a,r),e.getTournamentCountPerType(a,r),e.getChallengeRatioStats(),e.getUserStats(a,r),e.updateQueries(e.engagement1Queries,a,r),e.updateQueries(e.engagement3Queries,a,r),e.updateQueries(e.engagement4Queries,a,r),e.updateQueries(e.gamesQueries,a,r)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.date$.complete()}},{key:"getRevenueStats",value:function(e,t){this.revenueStats$=this.api.get(k.a.RevenueStats,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){var t=[],n=[];e.length&&(n=[{type:"Duelit",result:e.reduce((function(e,t){return e+t.duelit_revenue}),0)},{type:"Player",result:e.reduce((function(e,t){return e+t.player_revenue}),0)}]),t.push({title:"Revenue Generated",classSelector:"revenue1",viewType:"bar",data:n}),t.push({title:"Revenue Generated (Percentage)",classSelector:"revenue2",viewType:"pie",data:n});var i={title:"Revenue by Game (Duelit)",classSelector:"revenue3",viewType:"pie",data:e.map((function(e){return{type:e.game,result:e.duelit_revenue}}))};return t.push(i),t})))}},{key:"getSignupTypeStats",value:function(e,t){this.signupTypeStats$=this.api.get(k.e.SignupType,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){var t=[];return"0"===e.facebook&&"0"===e.apple&&"0"===e.email||Object.keys(e).forEach((function(n){t.push({type:n.charAt(0).toUpperCase()+n.slice(1),result:e[n]})})),[{title:"Signup Type",classSelector:"signup-type",viewType:"pie",data:t}]})))}},{key:"getSignupCountStats",value:function(e,t){var n=this;this.signupCountStats$=this.api.get(k.e.SignupCount,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){return[{name:U.b.SignupCount,title:"Total Sign Ups",subTitle:"Count - Sign up",data:n.numberPipe.transform(e.signups)},{name:U.b.ActivatedSignupCount,title:"Total Activated Sign Ups",subTitle:"Count - Sign up activated",data:n.numberPipe.transform(e.activated)}]})))}},{key:"getSignupRatioStats",value:function(){var e=this;this.signupCountStats$.subscribe((function(t){var n=0;t[0].data&&t[1].data&&(n=t[0].data.replace(/,/g,"")-t[1].data.replace(/,/g,""));var i=[{type:"Activated",result:t[1].data?t[1].data.replace(/,/g,""):0},{type:"Pending",result:n}];e.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie",data:i}}))}},{key:"getActiveUsersStats",value:function(e,t){this.activeUsersStats$=this.api.get(k.e.ActiveUsersStats,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){return[{title:"Active Users",subTitle:"Count - Active Users",data:e.active_users_count}]})))}},{key:"getChallengeStats",value:function(e,t){var n=this;this.challengeStats$=this.api.get(k.d.ChallengeStats,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){return[{title:"Cancelled",subTitle:"Cancelled Challenges",data:e.cancelled?n.numberPipe.transform(e.cancelled):0},{title:"Completed",subTitle:"Completed Challenges",data:e.completed?n.numberPipe.transform(e.completed):0}]})))}},{key:"getCreatedChallengePerHrStats",value:function(e,t){this.createdChallengePerHrStats$=this.api.get(k.d.ChallengePerHrStats,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){var t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(var n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Created Challenge",classSelector:"total-challenge-sent",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]})))}},{key:"getCompletedChallengePerHrStats",value:function(e,t){this.completedChallengePerHrStats$=this.api.get(k.d.ChallengePerHrStats,{query:{status:"Ended",start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})),Object(I.a)((function(e){var t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(var n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Completed Challenge",classSelector:"total-challenge-Completed",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]})))}},{key:"getTournamentCountPerType",value:function(e,t){this.tournamentCountPerType$=this.api.get(k.d.TournamentCountPerType,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)([])})))}},{key:"getChallengeRatioStats",value:function(){var e=this;this.challengeStats$.subscribe((function(t){var n=[{type:"Cancelled",result:t[0].data?t[0].data.replace(/,/g,""):0},{type:"Completed",result:t[1].data?t[1].data.replace(/,/g,""):0}];e.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie",data:n}}))}},{key:"getUserStats",value:function(e,t){var n=this,i=this.api.buildPath(k.e.UsersCountByStatus,["banned"]);this.userStats$=this.api.get(i,{query:{start_date:O(e).format(U.c),end_date:O(t).format(U.c)}}).pipe(Object(w.a)((function(e){return Object(S.a)(e.error.text||n.FAILED_TO_RETRIEVE)})),Object(I.a)((function(e){return[{title:"Total Banned Users",subTitle:"Count - Banned Users",data:e}]})))}},{key:"updateQueries",value:function(e,t,n){var i;i=t===n&&t===O().format(U.c)?"this_1_days":{start:t,end:n},e.forEach((function(e){"string"!=typeof e.query.timeframe&&(e.query=Object.assign(Object.assign({},e.query),{timeframe:i}))}))}},{key:"updateDate",value:function(){this.date$.next(Object.assign({},this.dashboardDate.range))}},{key:"isDateRangeValid",value:function(){var e=this.rangeDate.value;return e.from&&e.to}},{key:"openUsersSignup",value:function(e){var t=this.date$.getValue(),n=t.from,i=t.to,a=Object(A.b)(n).format(U.c),r=Object(A.b)(i).format(U.c);this.router.navigate(["/admin/users"],{queryParams:{created_start_date:a,created_end_date:r,not_status:e.name===U.b.ActivatedSignupCount?"pending":""}})}},{key:"openUsersByBanned",value:function(){var e=this.date$.getValue(),t=e.from,n=e.to,i=Object(A.b)(t).format(U.c),a=Object(A.b)(n).format(U.c);this.router.navigate(["/admin/users"],{queryParams:{status:U.f.Banned,start_date:i,end_date:a}})}},{key:"openUsersByTransaction",value:function(e){var t=this.date$.getValue(),n=t.from,i=t.to,a=Object(A.b)(n).format(U.c),r=Object(A.b)(i).format(U.c);this.router.navigate(["/admin/users"],{queryParams:{transaction:U.e.RedeemCoinsRequest,start_date:a,end_date:r}})}},{key:"openActiveUsers",value:function(){var e=this.date$.getValue(),t=e.from,n=e.to,i=Object(A.b)(t).format(U.c),a=Object(A.b)(n).format(U.c);this.router.navigate(["/admin/users"],{queryParams:{last_active_start_date:i,last_active_end_date:a}})}}]),e}()).\u0275fac=function(e){return new(e||oe)(d.Pb(j.a),d.Pb(x.a),d.Pb(C.b),d.Pb(u.f))},oe.\u0275cmp=d.Jb({type:oe,selectors:[["duelit-app-data"]],decls:49,vars:45,consts:[[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],[1,"row","container"],[4,"ngIf","ngIfElse"],["class","col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult",4,"ngFor","ngForOf"],["class","col metric",3,"title","keenName","viewType","queryType","query",4,"ngFor","ngForOf"],["class","col-6 metric",3,"title","keenName","viewType","queryType","query",4,"ngFor","ngForOf"],[1,"col-4"],["loading",""],["class","col-4",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-4",3,"keenApiInput"],[1,"col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult"],["class","col-12",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-12",3,"keenApiInput"],["class","col-4 pointer",3,"metric",4,"ngFor","ngForOf"],[1,"col-4","pointer",3,"metric"],["class","col-4 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-4","pointer",3,"metric","click"],[1,"col","metric",3,"title","keenName","viewType","queryType","query"],[1,"col-6","metric",3,"title","keenName","viewType","queryType","query"],[1,"col","col-loading"],[1,"metric","loading"]],template:function(e,t){if(1&e&&(d.Vb(0,"div",0),d.Qb(1,"duelit-date-picker-range",1),d.Vb(2,"button",2),d.hc("click",(function(){return t.updateDate()})),d.Lc(3,"Filter"),d.Ub(),d.Ub(),d.Vb(4,"div"),d.Vb(5,"h4"),d.Lc(6,"Revenue"),d.Ub(),d.Vb(7,"div",3),d.Jc(8,Q,2,1,"ng-container",4),d.mc(9,"async"),d.Ub(),d.Vb(10,"h4"),d.Lc(11,"Games"),d.Ub(),d.Vb(12,"div",3),d.Jc(13,F,1,7,"duelit-keen",5),d.Ub(),d.Vb(14,"h4"),d.Lc(15,"Engagement"),d.Ub(),d.Vb(16,"div",3),d.Jc(17,N,2,1,"ng-container",4),d.mc(18,"async"),d.Ub(),d.Vb(19,"div",3),d.Jc(20,G,2,1,"ng-container",4),d.mc(21,"async"),d.Ub(),d.Vb(22,"div",3),d.Jc(23,z,2,1,"ng-container",4),d.mc(24,"async"),d.Jc(25,Y,2,1,"ng-container",4),d.mc(26,"async"),d.Ub(),d.Vb(27,"div",3),d.Jc(28,X,2,1,"ng-container",4),d.mc(29,"async"),d.Jc(30,W,2,1,"ng-container",4),d.mc(31,"async"),d.Ub(),d.Vb(32,"div",3),d.Jc(33,Z,1,5,"duelit-keen",6),d.Ub(),d.Vb(34,"div",3),d.Jc(35,ee,1,5,"duelit-keen",7),d.Ub(),d.Vb(36,"h4"),d.Lc(37,"User Statistics"),d.Ub(),d.Vb(38,"div",3),d.Jc(39,ne,2,1,"ng-container",4),d.mc(40,"async"),d.Jc(41,ae,2,1,"ng-container",4),d.mc(42,"async"),d.Jc(43,ce,2,1,"ng-container",4),d.mc(44,"async"),d.Qb(45,"div",8),d.Qb(46,"div",8),d.Ub(),d.Ub(),d.Jc(47,se,2,0,"ng-template",null,9,d.Kc)),2&e){var n=d.zc(48);d.Cb(1),d.rc("formControl",t.rangeDate),d.Cb(1),d.rc("disabled",!t.isDateRangeValid()),d.Cb(6),d.rc("ngIf",d.nc(9,25,t.revenueStats$))("ngIfElse",n),d.Cb(5),d.rc("ngForOf",t.gamesQueries),d.Cb(4),d.rc("ngIf",d.nc(18,27,t.createdChallengePerHrStats$))("ngIfElse",n),d.Cb(3),d.rc("ngIf",d.nc(21,29,t.completedChallengePerHrStats$))("ngIfElse",n),d.Cb(3),d.rc("ngIf",d.nc(24,31,t.challengeStats$))("ngIfElse",n),d.Cb(2),d.rc("ngIf",d.nc(26,33,t.challengeStats$))("ngIfElse",n),d.Cb(3),d.rc("ngIf",d.nc(29,35,t.signupCountStats$))("ngIfElse",n),d.Cb(2),d.rc("ngIf",d.nc(31,37,t.signupCountStats$))("ngIfElse",n),d.Cb(3),d.rc("ngForOf",t.engagement3Queries),d.Cb(2),d.rc("ngForOf",t.engagement4Queries),d.Cb(4),d.rc("ngIf",d.nc(40,39,t.signupTypeStats$))("ngIfElse",n),d.Cb(2),d.rc("ngIf",d.nc(42,41,t.activeUsersStats$))("ngIfElse",n),d.Cb(2),d.rc("ngIf",d.nc(44,43,t.userStats$))("ngIfElse",n)}},directives:[q.a,l.l,l.e,u.n,u.m,R.a,D,J.a],pipes:[u.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}"]}),oe),be=n("5+tZ"),de=n("Olgc");function fe(e,t){1&e&&d.Qb(0,"duelit-metric",8),2&e&&d.rc("metric",t.$implicit)}function ge(e,t){if(1&e&&(d.Tb(0),d.Jc(1,fe,1,1,"duelit-metric",7),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function me(e,t){if(1&e){var n=d.Wb();d.Vb(0,"duelit-metric",10),d.hc("click",(function(){d.Cc(n);var e=t.$implicit;return d.lc(2).openUsersByTransaction(e)})),d.Ub()}2&e&&d.rc("metric",t.$implicit)}function he(e,t){if(1&e&&(d.Tb(0),d.Jc(1,me,1,1,"duelit-metric",9),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function ye(e,t){1&e&&(d.Vb(0,"div",11),d.Qb(1,"span",12),d.Ub())}function ve(e,t){if(1&e){var n=d.Wb();d.Vb(0,"duelit-metric",14),d.hc("click",(function(){d.Cc(n);var e=t.$implicit;return d.lc(2).openUsersByTransaction(e)})),d.Ub()}2&e&&d.rc("metric",t.$implicit)}function Ce(e,t){if(1&e&&(d.Tb(0),d.Jc(1,ve,1,1,"duelit-metric",13),d.Sb()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function ke(e,t){if(1&e&&(d.Tb(0),d.Qb(1,"duelit-metric",15),d.Sb()),2&e){var n=d.lc();d.Cb(1),d.rc("metric",n.totalProfitStats$)}}var Oe,Te,_e=((Oe=function(){function e(t,n,i,a,r,c){_classCallCheck(this,e),this.api=t,this.dashboardDate=n,this.toast=i,this.router=a,this.numberPipe=r,this.currencyPipe=c,this.ngUnsubscribe=new T.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.rangeDate=new l.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe((function(t){e.dashboardDate.range=t})),this.date$=new _.a(this.dashboardDate.range),this.totalCredits$=this.api.get(k.c.TotalCredits).pipe(Object(w.a)((function(e){return Object(S.a)({totalCoins:0,giftedCoins:0})})),Object(I.a)((function(t){return[{title:"Total Coins",subTitle:"Count - Total In-game Coins",data:t.totalCoins?e.numberPipe.transform(t.totalCoins):"0"},{title:"Total Gifted Coins",subTitle:"Count - Total Gifted Coins",data:t.giftedCoins?e.numberPipe.transform(t.giftedCoins):"0"}]}))),this.date$.subscribe((function(t){var n=t.from,i=t.to,a=Object(A.b)(n).format(U.c),r=Object(A.b)(i).format(U.c);e.getRedeemedStats(a,r),e.getTotalProfitStats(),e.productsSold$=e.api.get(k.c.PurchasedCoins,{query:{start_date:a,end_date:r}}).pipe(Object(w.a)((function(t){return e.toast.error(t.error||t.statusText||t.message),Object(S.a)([{amount:"4.99",count:0},{amount:"9.99",count:0},{amount:"25.99",count:0},{amount:"49.99",count:0}])})),Object(I.a)((function(e){return e.map((function(e){return{name:U.b.PurchasedCount,title:null,subTitle:"Count - Total Purchased $".concat(e.amount),data:e.count,amount:Number(e.amount)}}))})))}))}},{key:"updateDate",value:function(){this.date$.next(Object.assign({},this.dashboardDate.range))}},{key:"isDateRangeValid",value:function(){var e=this.rangeDate.value;return e.from&&e.to}},{key:"getRedeemedStats",value:function(e,t){var n=this;this.redeemedStats$=this.api.get(k.c.RedeemedCoins,{query:{start_date:e,end_date:t}}).pipe(Object(w.a)((function(e){return Object(S.a)({totalAmount:U.d,playerCount:U.d})})),Object(I.a)((function(e){var t,i;try{t=parseInt(e.totalAmount),i=Math.floor(.00825*t*100)/100}catch(r){console.log("Invalid coin amount",r)}var a="$0<br>0 coins";return i&&t&&(a="".concat(n.currencyPipe.transform(i),"<br>").concat(n.numberPipe.transform(t)," coins")),[{name:U.b.RedeemCount,title:"Total Redeems",subTitle:"Redeem Stats",data:a,class:"coin-dollar-metric",amount:i},{name:U.b.RedeemCount,title:"Redeemed Players Count",subTitle:"Count - Players Count",data:e.playerCount}]})))}},{key:"getTotalProfitStats",value:function(){var e,t=this;this.redeemedStats$.pipe(Object(be.a)((function(n){return e=n[0].amount,t.productsSold$}))).subscribe((function(n){var i=n.reduce((function(e,t){return e+t.amount*Number(t.data)}),0)-e,a="$0<br>0 coins";i&&(a="".concat(t.currencyPipe.transform(i),"<br>").concat(t.numberPipe.transform(Math.floor(i/.00825))," coins")),t.totalProfitStats$={title:"Total Profit",subTitle:"Total Profit Stats",data:a,class:"coin-dollar-metric"}}))}},{key:"openUsersByTransaction",value:function(e){var t=this.date$.getValue(),n=t.from,i=t.to,a=Object(A.b)(n).format(U.c),r=Object(A.b)(i).format(U.c),c={transaction:U.e.RedeemCoinsRequest,start_date:a,end_date:r};e.name===U.b.PurchasedCount&&(c.transaction=U.e.Transaction,c.amount=e.amount),this.router.navigate(["/admin/users"],{queryParams:c})}}]),e}()).\u0275fac=function(e){return new(e||Oe)(d.Pb(j.a),d.Pb(x.a),d.Pb(de.a),d.Pb(C.b),d.Pb(u.f),d.Pb(u.d))},Oe.\u0275cmp=d.Jb({type:Oe,selectors:[["duelit-finance"]],decls:27,vars:18,consts:[[1,"row","container"],[4,"ngIf","ngIfElse"],[1,"divider"],[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],["loading",""],["class","col-6",3,"metric",4,"ngFor","ngForOf"],[1,"col-6",3,"metric"],["class","col-3 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-3","pointer",3,"metric","click"],[1,"col","col-loading"],[1,"metric","loading"],["class","col-6 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-6","pointer",3,"metric","click"],[1,"col-12",3,"metric"]],template:function(e,t){if(1&e&&(d.Vb(0,"h4"),d.Lc(1,"Coins"),d.Ub(),d.Vb(2,"div",0),d.Jc(3,ge,2,1,"ng-container",1),d.mc(4,"async"),d.Ub(),d.Qb(5,"div",2),d.Vb(6,"div",3),d.Qb(7,"duelit-date-picker-range",4),d.Vb(8,"button",5),d.hc("click",(function(){return t.updateDate()})),d.Lc(9,"Filter"),d.Ub(),d.Ub(),d.Vb(10,"h4"),d.Lc(11,"Purchased Product"),d.Ub(),d.Vb(12,"div",0),d.Jc(13,he,2,1,"ng-container",1),d.mc(14,"async"),d.Ub(),d.Jc(15,ye,2,0,"ng-template",null,6,d.Kc),d.Vb(17,"h4"),d.Lc(18,"Redeemed Coins"),d.Ub(),d.Vb(19,"div",0),d.Jc(20,Ce,2,1,"ng-container",1),d.mc(21,"async"),d.Ub(),d.Vb(22,"h4"),d.Lc(23,"Total Profit"),d.Ub(),d.Vb(24,"div",0),d.Jc(25,ke,2,1,"ng-container",1),d.mc(26,"async"),d.Ub()),2&e){var n=d.zc(16);d.Cb(3),d.rc("ngIf",d.nc(4,10,t.totalCredits$))("ngIfElse",n),d.Cb(4),d.rc("formControl",t.rangeDate),d.Cb(1),d.rc("disabled",!t.isDateRangeValid()),d.Cb(5),d.rc("ngIf",d.nc(14,12,t.productsSold$))("ngIfElse",n),d.Cb(7),d.rc("ngIf",d.nc(21,14,t.redeemedStats$))("ngIfElse",n),d.Cb(5),d.rc("ngIf",d.nc(26,16,t.redeemedStats$))("ngIfElse",n)}},directives:[u.n,q.a,l.l,l.e,u.m,J.a],pipes:[u.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}",".divider[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:20px}"]}),Oe),Se=n("PqYM"),Pe=n("l7GE"),we=n("ZUHj"),Ie=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ue(e,this.notifier,t))}}]),e}(),Ue=function(e){function t(e,n,i){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).notifier=n,a.source=i,a.sourceIsBeingSubscribedTo=!0,a}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,i,a){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)}},{key:"notifyComplete",value:function(e){if(!1===this.sourceIsBeingSubscribedTo)return _get(_getPrototypeOf(t.prototype),"complete",this).call(this)}},{key:"complete",value:function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return _get(_getPrototypeOf(t.prototype),"complete",this).call(this);this._unsubscribeAndRecycle(),this.notifications.next()}}},{key:"_unsubscribe",value:function(){var e=this.notifications,t=this.retriesSubscription;e&&(e.unsubscribe(),this.notifications=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._unsubscribe;return this._unsubscribe=null,_get(_getPrototypeOf(t.prototype),"_unsubscribeAndRecycle",this).call(this),this._unsubscribe=e,this}},{key:"subscribeToRetries",value:function(){var e;this.notifications=new T.a;try{e=(0,this.notifier)(this.notifications)}catch(n){return _get(_getPrototypeOf(t.prototype),"complete",this).call(this)}this.retries=e,this.retriesSubscription=Object(we.a)(this,e)}}]),t}(Pe.a),Ae=n("bOdf"),je={asc:"desc",desc:"","":"asc"},xe=((Te=function(){function e(){_classCallCheck(this,e),this.duelitSortable="",this.direction="",this.tableName="",this.sort=new d.o}return _createClass(e,[{key:"rotate",value:function(){this.direction=je[this.direction],this.sort.emit({column:this.duelitSortable,direction:this.direction})}},{key:"_t",get:function(){return!0}},{key:"isAscending",get:function(){return"asc"===this.direction}},{key:"isDescending",get:function(){return"desc"===this.direction}}]),e}()).\u0275fac=function(e){return new(e||Te)},Te.\u0275dir=d.Kb({type:Te,selectors:[["th","duelitSortable",""]],hostVars:6,hostBindings:function(e,t){1&e&&d.hc("click",(function(e){return t.rotate(e)})),2&e&&d.Hb("pointer",t._t)("asc",t.isAscending)("desc",t.isDescending)},inputs:{duelitSortable:"duelitSortable",direction:"direction",tableName:"tableName"},outputs:{sort:"sort"}}),Te);function qe(e,t){if(1&e){var n=d.Wb();d.Vb(0,"th",5),d.hc("sort",(function(e){return d.Cc(n),d.lc(2).onSort(e)})),d.Lc(1),d.Ub()}if(2&e){var i=t.$implicit;d.rc("duelitSortable",i),d.Cb(1),d.Mc(i.name)}}function Re(e,t){if(1&e&&(d.Vb(0,"th",8),d.Lc(1),d.Ub()),2&e){var n=d.lc().$implicit;d.Cb(1),d.Mc(n)}}function $e(e,t){if(1&e&&(d.Vb(0,"td"),d.Lc(1),d.Ub()),2&e){var n=d.lc().$implicit;d.Cb(1),d.Mc(n)}}function Ve(e,t){if(1&e&&(d.Tb(0),d.Jc(1,Re,2,1,"th",6),d.Jc(2,$e,2,1,"ng-template",null,7,d.Kc),d.Sb()),2&e){var n=t.index,i=d.zc(3);d.Cb(1),d.rc("ngIf",0===n)("ngIfElse",i)}}function Me(e,t){if(1&e&&(d.Vb(0,"tr"),d.Jc(1,Ve,4,2,"ng-container",4),d.Ub()),2&e){var n=t.$implicit;d.Cb(1),d.rc("ngForOf",n)}}function De(e,t){if(1&e&&(d.Vb(0,"table",2),d.Vb(1,"thead"),d.Vb(2,"tr"),d.Jc(3,qe,2,2,"th",3),d.Ub(),d.Ub(),d.Vb(4,"tbody"),d.Jc(5,Me,2,1,"tr",4),d.Ub(),d.Ub()),2&e){var n=d.lc();d.Cb(3),d.rc("ngForOf",n.headerMapping),d.Cb(2),d.rc("ngForOf",n.tableData)}}function Je(e,t){1&e&&d.Lc(0," No data to show.\n")}var Ee,Qe=((Ee=function(){function e(){_classCallCheck(this,e),this.headerMapping=[],this.data=[],this.sort=new d.o,this.sortDirection=""}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"getData",value:function(e,t){var n=t;return e.split(".").forEach((function(e){return n=n[e]})),String(n)}},{key:"onSort",value:function(e){var t=e.column,n=e.direction;this.headers.forEach((function(e){e.duelitSortable!==t&&(e.direction="")})),this.sortColumn=t,this.sortDirection=n}},{key:"tableData",get:function(){var e=this;return this.data.map((function(t){return e.headerMapping.map((function(n){return e.getData(n.path,t)}))})).sort((function(t,n){var i=e.headerMapping.indexOf(e.sortColumn);i<0&&(i=0);var a,r,c=(a=t[i])<(r=n[i])?-1:a>r?1:0;return"desc"===e.sortDirection?-1*c:c}))}}]),e}()).\u0275fac=function(e){return new(e||Ee)},Ee.\u0275cmp=d.Jb({type:Ee,selectors:[["duelit-table"]],viewQuery:function(e,t){var n;1&e&&d.Qc(xe,!0),2&e&&d.yc(n=d.ic())&&(t.headers=n)},inputs:{headerMapping:"headerMapping",data:"data",tableName:"tableName"},outputs:{sort:"sort"},decls:3,vars:2,consts:[["class","table table-striped",4,"ngIf","ngIfElse"],["noData",""],[1,"table","table-striped"],["scope","col",3,"duelitSortable","sort",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["scope","col",3,"duelitSortable","sort"],["scope","row",4,"ngIf","ngIfElse"],["td",""],["scope","row"]],template:function(e,t){if(1&e&&(d.Jc(0,De,6,2,"table",0),d.Jc(1,Je,1,0,"ng-template",null,1,d.Kc)),2&e){var n=d.zc(2);d.rc("ngIf",t.data.length)("ngIfElse",n)}},directives:[u.n,u.m,xe],styles:['th.asc[_ngcontent-%COMP%]:before, th.desc[_ngcontent-%COMP%]:before{content:"";display:block;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAmxJREFUeAHtmksrRVEUx72fH8CIGQNJkpGUUmakDEiZSJRIZsRQmCkTJRmZmJgQE0kpX0D5DJKJgff7v+ru2u3O3vvc67TOvsdatdrnnP1Y///v7HvvubdbUiIhBISAEBACQkAICAEhIAQ4CXSh2DnyDfmCPEG2Iv9F9MPlM/LHyAecdyMzHYNwR3fdNK/OH9HXl1UCozD24TCvILxizEDWIEzA0FcM8woCgRrJCoS5PIwrANQSMAJX1LEI9bqpQo4JYNFFKRSvIgsxHDVnqZgIkPnNBM0rIGtYk9YOOsqgbgepRCfdbmFtqhFkVEDVPjJp0+Z6e6hRHhqBKgg6ZDCvYBygVmUoEGoh5JTRvIJwhJo1aUOoh4CLPMyvxxi7EWOMgnCGsXXI1GIXlZUYX7ucU+kbR8NW8lh3O7cue0Pk32MKndfUxQFAwxdirk3fHappAnc0oqDPzDfGTBrCfHP04dM4oTV8cxr0SVzH9FF07xD3ib6xCDE+M+aUcVygtWzzbtGX2rPBrEUYfecfQkaFzYi6HjVnGBdtL7epqAlc1+jRdAap74RrnPc4BCijttY2tRcdN0g17w7HqZrXhdJTYAuS3hd8z+vKgK3V1zWPae0mZDMykadBn1hTQBLnZNwVrJpSe/NwEeDsEwCctEOsJTsgxLvCqUl2ACftEGvJDgjxrnBqkh3ASTvEWrIDQrwrnJpkB3DSDrGW7IAQ7wqnJtkBnLRztejXXVu4+mxz/nQ9jR1w5VB86ejLTFcnnDwhzV+F6T+CHZlx6THSjn76eyyBIOPHyDakhBAQAkJACAgBISAEhIAQYCLwC8JxpAmsEGt6AAAAAElFTkSuQmCC") no-repeat;background-size:auto;background-size:22px;width:22px;height:22px;float:left;margin-left:-22px}th.desc[_ngcontent-%COMP%]:before{-webkit-transform:rotate(180deg);transform:rotate(180deg);-ms-transform:rotate(180deg)}']}),Ee);function Fe(e,t){1&e&&(d.Vb(0,"div",3),d.Qb(1,"span",4),d.Ub())}function Le(e,t){if(1&e&&(d.Tb(0),d.Qb(1,"duelit-table",5),d.Sb()),2&e){var n=t.$implicit,i=d.lc();d.Cb(1),d.rc("data",n)("headerMapping",i.tableHeadersMapping)}}var Ne,Be=((Ne=function(){function e(t){_classCallCheck(this,e),this.api=t,this.ngUnsubscribe=new T.a,this.POLL_INTERVAL=1e4,this.timer$=new _.a(this.POLL_INTERVAL/1e3),this._stop=new T.a,this._start=new T.a,this.tableHeadersMapping=[{name:"ID",path:"tournament_id"},{name:"Game Name",path:"game_name"},{name:"Joined Players",path:"total_players"},{name:"Real Players",path:"total_real_players"},{name:"Minimum Players",path:"minimum_players"},{name:"Status",path:"status"},{name:"Total Payout",path:"total_payout"},{name:"Level",path:"level"},{name:"Time Left",path:"time_left"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e,t=this;Object(Se.a)(0,1e3).pipe(Object(I.a)((function(e){return t.POLL_INTERVAL/1e3-e})),Object(P.a)(this._stop),(e=function(){return t._start},function(t){return t.lift(new Ie(e))})).subscribe((function(e){t.timer$.next(e)})),this.openTournaments$=Object(Se.a)(0,this.POLL_INTERVAL).pipe(Object(Ae.a)((function(){return t.api.get(k.d.GetOccupiedOpenTournaments).pipe(Object(w.a)((function(e){return Object(S.a)({})})))})),Object(I.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===e&&(e={}),t.restartTimer();var n=t.getTournamentListByStatus(e,"Started");return n=t.mapTimeLeft(n)})),Object(P.a)(this.ngUnsubscribe))}},{key:"getTournamentListByStatus",value:function(e,t){return Object.keys(e).filter((function(n){return e[n].status===t})).map((function(t){return e[t]}))}},{key:"mapTimeLeft",value:function(e){var t=O();return e.filter((function(e){var n=O.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss");return 0===t.diff(n,"hours")})).map((function(e){var n=O.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss"),i=O.duration(t.diff(n)),a=10-i.minutes(),r=60-i.seconds();return e.time_left="",a>0&&(e.time_left+="".concat(a," mins ")),e.time_left+="".concat(r," secs"),e}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"restartTimer",value:function(){this._stop.next(),this._start.next()}}]),e}()).\u0275fac=function(e){return new(e||Ne)(d.Pb(j.a))},Ne.\u0275cmp=d.Jb({type:Ne,selectors:[["duelit-realtime"]],decls:9,vars:7,consts:[["loading",""],[1,"d-inline","pr-1"],[4,"ngIf","ngIfElse"],[1,"col","col-loading"],[1,"metric","loading"],[3,"data","headerMapping"]],template:function(e,t){if(1&e&&(d.Jc(0,Fe,2,0,"ng-template",null,0,d.Kc),d.Vb(2,"h4",1),d.Lc(3,"Active Tournaments"),d.Ub(),d.Vb(4,"span"),d.Lc(5),d.mc(6,"async"),d.Ub(),d.Jc(7,Le,2,2,"ng-container",2),d.mc(8,"async")),2&e){var n=d.zc(1);d.Cb(5),d.Nc("(Refreshing in ",d.nc(6,3,t.timer$)," seconds)"),d.Cb(2),d.rc("ngIf",d.nc(8,5,t.openTournaments$))("ngIfElse",n)}},directives:[u.n,Qe],pipes:[u.b],styles:[".col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}"]}),Ne);function Ge(e,t){1&e&&d.Qb(0,"duelit-app-data")}function He(e,t){1&e&&d.Qb(0,"duelit-finance")}function ze(e,t){1&e&&d.Qb(0,"duelit-realtime")}var Ye,Ke,Xe=[{path:"",component:(Ye=function e(){_classCallCheck(this,e),this.activeTab="Application Data"},Ye.\u0275fac=function(e){return new(e||Ye)},Ye.\u0275cmp=d.Jb({type:Ye,selectors:[["duelit-dashboard"]],decls:18,vars:2,consts:[["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],["ngbNavItem","Application Data"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","Finance"],["ngbNavItem","Realtime Data"],[1,"timezone"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(e,t){if(1&e&&(d.Vb(0,"ul",0,1),d.hc("activeIdChange",(function(e){return t.activeTab=e})),d.Vb(2,"li",2),d.Vb(3,"a",3),d.Lc(4,"App"),d.Ub(),d.Jc(5,Ge,1,0,"ng-template",4),d.Ub(),d.Vb(6,"li",5),d.Vb(7,"a",3),d.Lc(8,"Finance"),d.Ub(),d.Jc(9,He,1,0,"ng-template",4),d.Ub(),d.Vb(10,"li",6),d.Vb(11,"a",3),d.Lc(12,"Realtime"),d.Ub(),d.Jc(13,ze,1,0,"ng-template",4),d.Ub(),d.Vb(14,"li",7),d.Vb(15,"span"),d.Lc(16,"Timezone: UTC"),d.Ub(),d.Ub(),d.Ub(),d.Qb(17,"div",8)),2&e){var n=d.zc(1);d.rc("activeId",t.activeTab),d.Cb(17),d.rc("ngbNavOutlet",n)}},directives:[p.o,p.q,p.r,p.p,p.t,pe,_e,Be],styles:[".timezone[_ngcontent-%COMP%]{display:-webkit-box;display:flex;float:right;-webkit-box-flex:1;flex-grow:1;-webkit-box-pack:right;justify-content:right;-webkit-box-align:center;align-items:center;padding-right:1em}"]}),Ye)}],We=((Ke=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:Ke}),Ke.\u0275inj=d.Mb({factory:function(e){return new(e||Ke)},imports:[[C.e.forChild(Xe)],C.e]}),Ke);n.d(t,"DashboardModule",(function(){return et}));var Ze,et=((Ze=function e(){_classCallCheck(this,e)}).\u0275mod=d.Nb({type:Ze}),Ze.\u0275inj=d.Mb({factory:function(e){return new(e||Ze)},providers:[u.f,u.d],imports:[[u.c,We,p.s,b.a,l.q,m,h,y.a,v.a,g]]}),Ze)}}]);