(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{XRCK:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),a=n("3Pt+"),s=n("1kSV"),c=n("ftNi"),r=n("fXoL");let o=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})(),l=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[i.c,o]]}),e})(),u=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})(),b=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[i.c,u]]}),e})();var d=n("S48G"),p=n("geAU"),m=n("tyNb"),g=n("Znnd"),h=n("wd/R"),f=n("XNiG"),y=n("2Vo4"),C=n("LRne"),v=n("1G5W"),T=n("JIr8"),O=n("lJxs"),S=n("5+tZ"),k=n("SLWe"),w=n("YGOX"),_=n("qc5V"),$=n("aVeI"),I=n("lbBO"),P=n("BamM"),U=n("J+vq"),x=n("h7dw");let A=(()=>{class e{constructor(e,t,n){this.el=e,this.renderer=t,this.keen=n,this.viewInit=!1,this.loading=!0}ngOnInit(){this.renderer.addClass(this.el.nativeElement,"duelit-keen-data")}ngOnChanges(){this.query&&this.viewInit&&(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.doQuery())}doQuery(){if(this.el.nativeElement.innerHTML='<span class="duelit-keen-data loading"></span>',this.chart=new U.Dataviz({container:`.${this.duelitkeenname}`,title:"metric"===this.viewType&&this.title,type:this.viewType,legend:{pagination:{limit:10}},labelMapping:{Regular:"Challenge",Open:"Tournament","Practice game":"Practice"}}),this.query.eventCollection instanceof Array){const e=[];this.query.eventCollection.forEach(t=>{e.push(this.keen.query(this.queryType,{eventCollection:t,timeframe:this.query.timeframe,timezone:"UTC"}))}),this.keen.run(e).then(e=>{const t=[];t.push({type:"Accepted",result:e[1].result},{type:"Rejected",result:e[0].result-e[1].result}),this.chart.render({query:{timeframe:this.query.timeframe,timezone:"UTC"},result:t})})}else this.loading=!0,this.keen.query(this.queryType,this.query).then(e=>{setTimeout(()=>{this.isCombined&&this.apiResult?(e.result=[e.result.find(e=>"Practice game"===e["Game.type"])],this.apiResult.subscribe(t=>{t.forEach(t=>{e.result.push({"Game.type":t.type,result:t.count})}),this.chart.render(e)})):this.chart.render(e)}),this.loading=!1}).catch(e=>{setTimeout(()=>{this.chart.message(e.message)}),this.loading=!1})}ngAfterViewInit(){this.viewInit=!0,this.doQuery()}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(r.l),r.Pb(r.F),r.Pb(x.a))},e.\u0275dir=r.Kb({type:e,selectors:[["","duelitKeenData",""]],inputs:{duelitkeenname:"duelitkeenname",viewType:"viewType",queryType:"queryType",query:"query",title:"title",isCombined:"isCombined",apiResult:"apiResult"},features:[r.Ab()]}),e})(),j=(()=>{class e{constructor(){this.loading=!0,this.viewInit=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-keen"]],inputs:{title:"title",keenName:"keenName",viewType:"viewType",queryType:"queryType",query:"query",subTitle:"subTitle",isCombined:"isCombined",apiResult:"apiResult"},decls:3,vars:11,consts:[["duelitKeenData","",1,"duelit-keen-data",3,"duelitkeenname","viewType","queryType","query","title","ngClass","isCombined","apiResult"]],template:function(e,t){1&e&&(r.Vb(0,"h6"),r.Lc(1),r.Ub(),r.Qb(2,"div",0)),2&e&&(r.Cb(1),r.Mc(t.title),r.Cb(1),r.Hb("metric","metric"===t.viewType),r.rc("duelitkeenname",t.keenName)("viewType",t.viewType)("queryType",t.queryType)("query",t.query)("title",t.subTitle)("ngClass",t.keenName)("isCombined",t.isCombined)("apiResult",t.apiResult))},directives:[A,i.l],styles:["[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]{height:250px;width:auto;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}[_nghost-%COMP%]   .duelit-keen-data[_ngcontent-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .duelit-keen-data.metric[_ngcontent-%COMP%]{height:unset}"]}),e})();var V=n("Jx61");function R(e,t){1&e&&r.Qb(0,"duelit-keen-api",9),2&e&&r.rc("keenApiInput",t.$implicit)}function q(e,t){if(1&e&&(r.Tb(0),r.Jc(1,R,1,1,"duelit-keen-api",8),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function E(e,t){if(1&e&&r.Qb(0,"duelit-keen",10),2&e){const e=t.$implicit,n=r.lc();r.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)("isCombined",e.isCombined)("apiResult",n.tournamentCountPerType$)}}function D(e,t){1&e&&r.Qb(0,"duelit-keen-api",12),2&e&&r.rc("keenApiInput",t.$implicit)}function L(e,t){if(1&e&&(r.Tb(0),r.Jc(1,D,1,1,"duelit-keen-api",11),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function M(e,t){1&e&&r.Qb(0,"duelit-keen-api",12),2&e&&r.rc("keenApiInput",t.$implicit)}function J(e,t){if(1&e&&(r.Tb(0),r.Jc(1,M,1,1,"duelit-keen-api",11),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function F(e,t){1&e&&r.Qb(0,"duelit-keen-api",12),2&e&&r.rc("keenApiInput",t.$implicit)}function Q(e,t){if(1&e&&(r.Tb(0),r.Jc(1,F,1,1,"duelit-keen-api",11),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function N(e,t){1&e&&r.Qb(0,"duelit-metric",14),2&e&&r.rc("metric",t.$implicit)}function B(e,t){if(1&e&&(r.Tb(0),r.Jc(1,N,1,1,"duelit-metric",13),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function G(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",15),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.challengeRatioStats$)}}function H(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",17),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc(2).openUsersSignup(n)})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function W(e,t){if(1&e&&(r.Tb(0),r.Jc(1,H,1,1,"duelit-metric",16),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function z(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",9),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.signupRatioStats$)}}function Y(e,t){if(1&e&&r.Qb(0,"duelit-keen",18),2&e){const e=t.$implicit;r.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)}}function K(e,t){if(1&e&&r.Qb(0,"duelit-keen",18),2&e){const e=t.$implicit;r.rc("title",e.title)("keenName",e.keenname)("viewType",e.viewType)("queryType",e.queryType)("query",e.query)}}function X(e,t){1&e&&r.Qb(0,"duelit-keen-api",9),2&e&&r.rc("keenApiInput",t.$implicit)}function Z(e,t){if(1&e&&(r.Tb(0),r.Jc(1,X,1,1,"duelit-keen-api",8),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function ee(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",17),r.hc("click",(function(){return r.Cc(e),r.lc(2).openActiveUsers()})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function te(e,t){if(1&e&&(r.Tb(0),r.Jc(1,ee,1,1,"duelit-metric",16),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function ne(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",17),r.hc("click",(function(){return r.Cc(e),r.lc(2).openUsersByBanned()})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function ie(e,t){if(1&e&&(r.Tb(0),r.Jc(1,ne,1,1,"duelit-metric",16),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function ae(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",17),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc(2).openConvertedUsers(n.type)})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function se(e,t){if(1&e&&(r.Tb(0),r.Jc(1,ae,1,1,"duelit-metric",16),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function ce(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",9),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.txnOnInsufficientFundsRatio$)}}function re(e,t){1&e&&(r.Vb(0,"div",19),r.Qb(1,"span",20),r.Ub())}const oe=h().subtract(6,"days").format(k.c),le=h().format(k.c);let ue=(()=>{class e{constructor(e,t,n,i){this.api=e,this.dashboardDate=t,this.router=n,this.numberPipe=i,this.gamesQueries=[{title:"Daily Games",keenname:"daily-games",viewType:"line",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.name",timeframe:{start:oe,end:le},interval:"daily",filters:[{property_name:"Game.name",operator:"ne",property_value:null}]}},{title:"Games Per Type",keenname:"games-per-type",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Game.type",timeframe:{start:oe,end:le}},isCombined:!0}],this.engagement1Queries=[{title:"Total Challenges",keenname:"challenges-total",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge created",timeframe:{start:oe,end:le}}},{title:"Accepted Challenges",keenname:"challenges-accepted",viewType:"metric",queryType:"count",query:{eventCollection:"Challenge accepted",timeframe:{start:oe,end:le}}},{title:"Challenge Ratio",keenname:"challenge-ratio",viewType:"pie",queryType:"count",query:{eventCollection:["Challenge created","Challenge accepted"],timeframe:{start:oe,end:le}}}],this.engagement3Queries=[{title:"Total App Launched",keenname:"app-launced-total",viewType:"metric",queryType:"count",query:{eventCollection:"App launched",timeframe:{start:oe,end:le}}}],this.engagement4Queries=[{title:"Games Per OS",keenname:"games-per-os",viewType:"pie",queryType:"count",query:{eventCollection:"Game played",groupBy:"Device.OS",timeframe:{start:oe,end:le},filters:[{property_name:"Device.OS",operator:"exists",property_value:!0}]}}],this.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie"},this.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie"},this.txnOnInsufficientFundsRatio$={title:"Transaction on Insufficient Funds",classSelector:"txn-on-insufficient-funds-ratio",viewType:"pie"},this.ngUnsubscribe=new f.a,this.FAILED_TO_RETRIEVE="-"}ngOnInit(){this.rangeDate=new a.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(v.a)(this.ngUnsubscribe)).subscribe(e=>{this.dashboardDate.range=e}),this.date$=new y.a(this.dashboardDate.range),this.date$.pipe(Object(v.a)(this.ngUnsubscribe)).subscribe(({from:e,to:t})=>{const n=h().year(e.year).month(e.month-1).date(e.day).format(k.c),i=h().year(t.year).month(t.month-1).date(t.day).format(k.c);this.getRevenueStats(n,i),this.getSignupTypeStats(n,i),this.getSignupCountStats(n,i),this.getSignupRatioStats(),this.getActiveUsersStats(n,i),this.getChallengeStats(n,i),this.getTxnOnInsufficientFunds(n,i),this.getCreatedChallengePerHrStats(n,i),this.getCompletedChallengePerHrStats(n,i),this.getCompletedTournamentPerHrStats(n,i),this.getTournamentCountPerType(n,i),this.getChallengeRatioStats(),this.getTxnOnInsufficientFundsRatio(),this.getUserStats(n,i),this.updateQueries(this.engagement1Queries,n,i),this.updateQueries(this.engagement3Queries,n,i),this.updateQueries(this.engagement4Queries,n,i),this.updateQueries(this.gamesQueries,n,i)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.date$.complete()}getRevenueStats(e,t){this.revenueStats$=this.api.get(g.a.RevenueStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];let n=[];e.length&&(n=[{type:"Duelit",result:e.reduce((e,t)=>e+t.duelit_revenue,0)},{type:"Player",result:e.reduce((e,t)=>e+t.player_revenue,0)}]),t.push({title:"Revenue Generated",classSelector:"revenue1",viewType:"bar",data:n}),t.push({title:"Revenue Generated (Percentage)",classSelector:"revenue2",viewType:"pie",data:n});const i={title:"Revenue by Game (Duelit)",classSelector:"revenue3",viewType:"pie",data:e.map(e=>({type:e.game,result:e.duelit_revenue}))};return t.push(i),t}))}getSignupTypeStats(e,t){this.signupTypeStats$=this.api.get(g.e.SignupType,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];return"0"===e.facebook&&"0"===e.apple&&"0"===e.email||Object.keys(e).forEach(n=>{t.push({type:n.charAt(0).toUpperCase()+n.slice(1),result:e[n]})}),[{title:"Signup Type",classSelector:"signup-type",viewType:"pie",data:t}]}))}getSignupCountStats(e,t){this.signupCountStats$=this.api.get(g.e.SignupCount,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{name:k.b.SignupCount,title:"Total Sign Ups",subTitle:"Count - Sign up",data:this.numberPipe.transform(e.signups)},{name:k.b.ActivatedSignupCount,title:"Total Activated Sign Ups",subTitle:"Count - Sign up activated",data:this.numberPipe.transform(e.activated)}]))}getSignupRatioStats(){this.signupCountStats$.subscribe(e=>{let t=0;e[0].data&&e[1].data&&(t=e[0].data.replace(/,/g,"")-e[1].data.replace(/,/g,""));const n=[{type:"Activated",result:e[1].data?e[1].data.replace(/,/g,""):0},{type:"Pending",result:t}];this.signupRatioStats$={title:"Signup Ratio",classSelector:"signup-ratio",viewType:"pie",data:n}})}getActiveUsersStats(e,t){this.activeUsersStats$=this.api.get(g.e.ActiveUsersStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Active Users",subTitle:"Count - Active Users",data:e.active_users_count}]))}getChallengeStats(e,t){this.challengeStats$=this.api.get(g.d.ChallengeStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Cancelled",subTitle:"Cancelled Challenges",data:e.cancelled?this.numberPipe.transform(e.cancelled):0},{title:"Completed",subTitle:"Completed Challenges",data:e.completed?this.numberPipe.transform(e.completed):0},{title:"Sent",subTitle:"Total Sent Challenges",data:this.numberPipe.transform((parseInt(e.cancelled)||0)+(parseInt(e.completed)||0))}]))}getTxnOnInsufficientFunds(e,t){const n=this.api.buildPath(g.e.UsersByConverted,["converted"]);this.txnOnInsufficientFunds$=this.api.get(n,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(S.a)(n=>{const i=this.api.buildPath(g.e.UsersByConverted,["churned"]);return this.api.get(i,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>[{title:"Users Converted when Coins Ran Out",subTitle:"Count",type:"converted",data:n.totalCount?this.numberPipe.transform(n.totalCount):0},{title:"Users Churned when Coins Ran Out",subTitle:"Count",type:"churned",data:e.totalCount?this.numberPipe.transform(e.totalCount):0}]))}))}getCreatedChallengePerHrStats(e,t){this.createdChallengePerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Created Challenge",classSelector:"total-challenge-sent",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getCompletedChallengePerHrStats(e,t){this.completedChallengePerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{status:"Ended",start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Completed Challenge",classSelector:"total-challenge-Completed",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getCompletedTournamentPerHrStats(e,t){this.completedTournamentPerHrStats$=this.api.get(g.d.TournamentPerHrStats,{query:{type:"open",status:"Ended",start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{const t=[];if(e&&Object.keys(e)&&Object.keys(e).length)for(let n=0;n<24;n++)t.push({type:n,count:e[n]||0});return[{title:"Completed Tournament",classSelector:"total-tournament-completed",viewType:"line",xAxisLabel:"Hour of day (in UTC)",yAxisLabel:"Count",data:t}]}))}getTournamentCountPerType(e,t){this.tournamentCountPerType$=this.api.get(g.d.TournamentCountPerType,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)([])))}getChallengeRatioStats(){this.challengeStats$.subscribe(e=>{const t=[{type:"Cancelled",result:e[0].data?e[0].data.replace(/,/g,""):0},{type:"Completed",result:e[1].data?e[1].data.replace(/,/g,""):0}];this.challengeRatioStats$={title:"Challenge Ratio",classSelector:"challenge-ratio",viewType:"pie",data:t}})}getTxnOnInsufficientFundsRatio(){this.txnOnInsufficientFunds$.subscribe(e=>{const t=[{type:"Converted",result:e[0].data?e[0].data.replace(/,/g,""):0},{type:"Churned",result:e[1].data?e[1].data.replace(/,/g,""):0}];this.txnOnInsufficientFundsRatio$={title:"Total User that Ran Out of Coins",classSelector:"transaction-ratio",viewType:"pie",data:t}})}getUserStats(e,t){const n=this.api.buildPath(g.e.UsersCountByStatus,["banned"]);this.userStats$=this.api.get(n,{query:{start_date:h(e).format(k.c),end_date:h(t).format(k.c)}}).pipe(Object(T.a)(e=>Object(C.a)(e.error.text||this.FAILED_TO_RETRIEVE)),Object(O.a)(e=>[{title:"Total Banned Users",subTitle:"Count - Banned Users",data:e}]))}updateQueries(e,t,n){let i;i={start:t,end:n},e.forEach(e=>{"string"!=typeof e.query.timeframe&&(e.query=Object.assign(Object.assign({},e.query),{timeframe:i}))})}updateDate(){this.date$.next(Object.assign({},this.dashboardDate.range))}isDateRangeValid(){const e=this.rangeDate.value;return e.from&&e.to}openUsersSignup(e){const{from:t,to:n}=this.date$.getValue(),i=Object(w.b)(t).format(k.c),a=Object(w.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{created_start_date:i,created_end_date:a,not_status:e.name===k.b.ActivatedSignupCount?"pending":""}})}openUsersByBanned(){const{from:e,to:t}=this.date$.getValue(),n=Object(w.b)(e).format(k.c),i=Object(w.b)(t).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{status:k.f.Banned,start_date:n,end_date:i}})}openUsersByTransaction(e){const{from:t,to:n}=this.date$.getValue(),i=Object(w.b)(t).format(k.c),a=Object(w.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{transaction:k.e.RedeemCoinsRequest,start_date:i,end_date:a}})}openActiveUsers(){const{from:e,to:t}=this.date$.getValue(),n=Object(w.b)(e).format(k.c),i=Object(w.b)(t).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{last_active_start_date:n,last_active_end_date:i}})}openConvertedUsers(e){const{from:t,to:n}=this.date$.getValue(),i=Object(w.b)(t).format(k.c),a=Object(w.b)(n).format(k.c);this.router.navigate(["/admin/users"],{queryParams:{convertedType:e,start_date:i,end_date:a}})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(_.a),r.Pb($.a),r.Pb(m.b),r.Pb(i.f))},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-app-data"]],decls:54,vars:57,consts:[[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],[1,"row","container"],[4,"ngIf","ngIfElse"],["class","col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult",4,"ngFor","ngForOf"],["class","col-6 metric",3,"title","keenName","viewType","queryType","query",4,"ngFor","ngForOf"],["loading",""],["class","col-4",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-4",3,"keenApiInput"],[1,"col-6",3,"title","keenName","viewType","queryType","query","isCombined","apiResult"],["class","col-12",3,"keenApiInput",4,"ngFor","ngForOf"],[1,"col-12",3,"keenApiInput"],["class","col-3 pointer",3,"metric",4,"ngFor","ngForOf"],[1,"col-3","pointer",3,"metric"],[1,"col-3",3,"keenApiInput"],["class","col-4 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-4","pointer",3,"metric","click"],[1,"col-6","metric",3,"title","keenName","viewType","queryType","query"],[1,"col","col-loading"],[1,"metric","loading"]],template:function(e,t){if(1&e&&(r.Vb(0,"div",0),r.Qb(1,"duelit-date-picker-range",1),r.Vb(2,"button",2),r.hc("click",(function(){return t.updateDate()})),r.Lc(3,"Filter"),r.Ub(),r.Ub(),r.Vb(4,"div"),r.Vb(5,"h4"),r.Lc(6,"Revenue"),r.Ub(),r.Vb(7,"div",3),r.Jc(8,q,2,1,"ng-container",4),r.mc(9,"async"),r.Ub(),r.Vb(10,"h4"),r.Lc(11,"Games"),r.Ub(),r.Vb(12,"div",3),r.Jc(13,E,1,7,"duelit-keen",5),r.Ub(),r.Vb(14,"h4"),r.Lc(15,"Engagement"),r.Ub(),r.Vb(16,"div",3),r.Jc(17,L,2,1,"ng-container",4),r.mc(18,"async"),r.Ub(),r.Vb(19,"div",3),r.Jc(20,J,2,1,"ng-container",4),r.mc(21,"async"),r.Ub(),r.Vb(22,"div",3),r.Jc(23,Q,2,1,"ng-container",4),r.mc(24,"async"),r.Ub(),r.Vb(25,"div",3),r.Jc(26,B,2,1,"ng-container",4),r.mc(27,"async"),r.Jc(28,G,2,1,"ng-container",4),r.mc(29,"async"),r.Ub(),r.Vb(30,"div",3),r.Jc(31,W,2,1,"ng-container",4),r.mc(32,"async"),r.Jc(33,z,2,1,"ng-container",4),r.mc(34,"async"),r.Ub(),r.Vb(35,"div",3),r.Jc(36,Y,1,5,"duelit-keen",6),r.Jc(37,K,1,5,"duelit-keen",6),r.Ub(),r.Vb(38,"h4"),r.Lc(39,"User Statistics"),r.Ub(),r.Vb(40,"div",3),r.Jc(41,Z,2,1,"ng-container",4),r.mc(42,"async"),r.Jc(43,te,2,1,"ng-container",4),r.mc(44,"async"),r.Jc(45,ie,2,1,"ng-container",4),r.mc(46,"async"),r.Ub(),r.Vb(47,"div",3),r.Jc(48,se,2,1,"ng-container",4),r.mc(49,"async"),r.Jc(50,ce,2,1,"ng-container",4),r.mc(51,"async"),r.Ub(),r.Ub(),r.Jc(52,re,2,0,"ng-template",null,7,r.Kc)),2&e){const e=r.zc(53);r.Cb(1),r.rc("formControl",t.rangeDate),r.Cb(1),r.rc("disabled",!t.isDateRangeValid()),r.Cb(6),r.rc("ngIf",r.nc(9,31,t.revenueStats$))("ngIfElse",e),r.Cb(5),r.rc("ngForOf",t.gamesQueries),r.Cb(4),r.rc("ngIf",r.nc(18,33,t.createdChallengePerHrStats$))("ngIfElse",e),r.Cb(3),r.rc("ngIf",r.nc(21,35,t.completedChallengePerHrStats$))("ngIfElse",e),r.Cb(3),r.rc("ngIf",r.nc(24,37,t.completedTournamentPerHrStats$))("ngIfElse",e),r.Cb(3),r.rc("ngIf",r.nc(27,39,t.challengeStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(29,41,t.challengeStats$))("ngIfElse",e),r.Cb(3),r.rc("ngIf",r.nc(32,43,t.signupCountStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(34,45,t.signupCountStats$))("ngIfElse",e),r.Cb(3),r.rc("ngForOf",t.engagement3Queries),r.Cb(1),r.rc("ngForOf",t.engagement4Queries),r.Cb(4),r.rc("ngIf",r.nc(42,47,t.signupTypeStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(44,49,t.activeUsersStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(46,51,t.userStats$))("ngIfElse",e),r.Cb(3),r.rc("ngIf",r.nc(49,53,t.txnOnInsufficientFunds$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(51,55,t.txnOnInsufficientFunds$))("ngIfElse",e)}},directives:[I.a,a.l,a.e,i.n,i.m,P.a,j,V.a],pipes:[i.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}"]}),e})();var be=n("Olgc");function de(e,t){1&e&&r.Qb(0,"duelit-metric",16),2&e&&r.rc("metric",t.$implicit)}function pe(e,t){if(1&e&&(r.Tb(0),r.Jc(1,de,1,1,"duelit-metric",15),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function me(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",18),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc(2).openUsersByTransaction(n)})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function ge(e,t){if(1&e&&(r.Tb(0),r.Jc(1,me,1,1,"duelit-metric",17),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function he(e,t){1&e&&(r.Vb(0,"div",19),r.Qb(1,"span",20),r.Ub())}function fe(e,t){if(1&e){const e=r.Wb();r.Vb(0,"duelit-metric",22),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc(2).openUsersByTransaction(n)})),r.Ub()}2&e&&r.rc("metric",t.$implicit)}function ye(e,t){if(1&e&&(r.Tb(0),r.Jc(1,fe,1,1,"duelit-metric",21),r.Sb()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function Ce(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-metric",23),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("metric",e.totalProfitStats$)}}function ve(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",24),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.coinsEarned$)}}function Te(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",24),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.coinsLost$)}}function Oe(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-metric",25),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("metric",e.coinsBalance$)}}function Se(e,t){if(1&e){const e=r.Wb();r.Tb(0),r.Vb(1,"button",26),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc().updateLevel(n)})),r.Lc(2),r.Ub(),r.Sb()}if(2&e){const e=t.$implicit,n=r.lc();r.Cb(1),r.Hb("selected",e===n.selectedLevel.value),r.Cb(1),r.Nc(" ",e," ")}}function ke(e,t){if(1&e){const e=r.Wb();r.Tb(0),r.Vb(1,"button",26),r.hc("click",(function(){r.Cc(e);const n=t.$implicit;return r.lc().updateGame(n.value)})),r.Lc(2),r.Ub(),r.Sb()}if(2&e){const e=t.$implicit,n=r.lc();r.Cb(1),r.Hb("selected",e.value===n.selectedGame.value),r.Cb(1),r.Nc(" ",e.label," ")}}function we(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-metric",25),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("metric",e.coinsWonReal$)}}function _e(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-metric",25),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("metric",e.coinsWonBot$)}}function $e(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-keen-api",24),r.Sb()),2&e){const e=r.lc();r.Cb(1),r.rc("keenApiInput",e.coinsWon$)}}let Ie=(()=>{class e{constructor(e,t,n,i,s,c){this.api=e,this.dashboardDate=t,this.toast=n,this.router=i,this.numberPipe=s,this.currencyPipe=c,this.levels=["All levels","beginner","intermediate","expert"],this.games=[{value:-1,label:"All Games"}],this.selectedLevel=new a.d(this.levels[0]),this.selectedGame=new a.d(this.games[0].value),this.coinsEarned$={title:"Coins Earned",classSelector:"coins-earned",viewType:"pie"},this.coinsLost$={title:"Coins Lost",classSelector:"coins-lost",viewType:"pie"},this.coinsWon$={title:"Coins Won",classSelector:"coins-won",viewType:"pie"},this.ngUnsubscribe=new f.a}ngOnInit(){this.rangeDate=new a.d(this.dashboardDate.range),this.rangeDate.valueChanges.pipe(Object(v.a)(this.ngUnsubscribe)).subscribe(e=>{this.dashboardDate.range=e}),this.date$=new y.a(this.dashboardDate.range),this.api.get(g.f.Games).subscribe(e=>{console.log("games"),e&&(this.games=this.games.concat(e.map(e=>({value:e.id,label:e.title}))))}),this.totalCredits$=this.api.get(g.c.TotalCredits).pipe(Object(T.a)(e=>Object(C.a)({totalCoins:0,giftedCoins:0})),Object(O.a)(e=>[{title:"Total Coins",subTitle:"Count - Total In-game Coins",data:e.totalCoins?this.numberPipe.transform(e.totalCoins):"0"},{title:"Total Gifted Coins",subTitle:"Count - Total Gifted Coins",data:e.giftedCoins?this.numberPipe.transform(e.giftedCoins):"0"}])),this.date$.subscribe(({from:e,to:t})=>{const n=Object(w.b)(e).format(k.c),i=Object(w.b)(t).format(k.c);this.getRedeemedStats(n,i),this.getTotalProfitStats(),this.getCoinsEarnedStats(n,i),this.getCoinsEarnedPositive(),this.getCoinsEarnedNegative(),this.getCoinsBalance(),this.getCoinsWonStats(n,i,this.selectedLevel.value===this.levels[0]?"":this.selectedLevel.value),this.productsSold$=this.api.get(g.c.PurchasedCoins,{query:{start_date:n,end_date:i}}).pipe(Object(T.a)(e=>(this.toast.error(e.error||e.statusText||e.message),Object(C.a)([{amount:"0.01",count:0},{amount:"4.99",count:0},{amount:"9.99",count:0},{amount:"25.99",count:0},{amount:"49.99",count:0}]))),Object(O.a)(e=>e.map(e=>({name:k.b.PurchasedCount,title:null,subTitle:`Count - Total ${e.amount&&"0.01"!==e.amount?`Purchased $${e.amount}`:"Watched Ads ($0.01)"}`,data:e.count,amount:Number(e.amount)}))))})}updateDate(){this.date$.next(Object.assign({},this.dashboardDate.range))}updateLevel(e){this.selectedLevel.setValue(e),this.getCoinsWonStats(`${this.dashboardDate.range.from.year}-${this.dashboardDate.range.from.month}-${this.dashboardDate.range.from.day}`,`${this.dashboardDate.range.to.year}-${this.dashboardDate.range.to.month}-${this.dashboardDate.range.to.day}`,this.selectedLevel.value===this.levels[0]?"":this.selectedLevel.value,this.selectedGame.value===this.games[0].value?"":this.selectedGame.value)}updateGame(e){this.selectedGame.setValue(e),this.getCoinsWonStats(`${this.dashboardDate.range.from.year}-${this.dashboardDate.range.from.month}-${this.dashboardDate.range.from.day}`,`${this.dashboardDate.range.to.year}-${this.dashboardDate.range.to.month}-${this.dashboardDate.range.to.day}`,this.selectedLevel.value===this.levels[0]?"":this.selectedLevel.value,this.selectedGame.value===this.games[0].value?"":this.selectedGame.value)}getSelectedGameLabel(){return this.games.find(e=>e.value===this.selectedGame.value).label}isDateRangeValid(){const e=this.rangeDate.value;return e.from&&e.to}getRedeemedStats(e,t){this.redeemedStats$=this.api.get(g.c.RedeemedCoins,{query:{start_date:e,end_date:t}}).pipe(Object(T.a)(e=>Object(C.a)({totalAmount:k.d,playerCount:k.d})),Object(O.a)(e=>{let t,n;try{t=parseInt(e.totalAmount),n=Math.floor(.00825*t*100)/100}catch(a){console.log("Invalid coin amount",a)}let i="$0<br>0 coins";return n&&t&&(i=`${this.currencyPipe.transform(n)}<br>${this.numberPipe.transform(t)} coins`),[{name:k.b.RedeemCount,title:"Total Redeems",subTitle:"Redeem Stats",data:i,class:"coin-dollar-metric",amount:n},{name:k.b.RedeemCount,title:"Redeemed Players Count",subTitle:"Count - Players Count",data:e.playerCount}]}))}getTotalProfitStats(){let e;this.redeemedStats$.pipe(Object(S.a)(t=>(e=t[0].amount,this.productsSold$))).subscribe(t=>{const n=t.reduce((e,t)=>e+t.amount*Number(t.data),0)-e;let i="$0<br>0 coins";n&&(i=`${this.currencyPipe.transform(n)}<br>${this.numberPipe.transform(Math.floor(n/.00825))} coins`),this.totalProfitStats$={title:"Total Profit",subTitle:"Total Profit Stats",data:i,class:"coin-dollar-metric"}})}getCoinsEarnedStats(e,t){this.coinsEarnedStats$=this.api.get(g.a.CoinsEarnedStats,{query:{start_date:e,end_date:t}}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>e))}getCoinsEarnedPositive(){this.coinsEarnedStats$.subscribe(e=>{var t,n;const i=[{type:"Real Lost",result:(t=e.real_lost_coins,null!=t?t:0)},{type:"Duelit Cut",result:(n=e.total_duelit_cut_prize,null!=n?n:0)}];this.coinsEarned$={title:"Coins Gained",classSelector:"coins-earned",viewType:"pie",data:i}})}getCoinsEarnedNegative(){this.coinsEarnedStats$.subscribe(e=>{var t,n;const i=[{type:"Coins Gifted",result:(t=e.coins_gifted,null!=t?t:0)},{type:"Bot Lost",result:(n=e.bot_lost_coins,null!=n?n:0)}];this.coinsLost$={title:"Coins Lost",classSelector:"coins-lost",viewType:"pie",data:i}})}getCoinsBalance(){this.coinsEarnedStats$.subscribe(e=>{var t;const n=null!=(t=e.real_lost_coins+e.total_duelit_cut_prize-(e.coins_gifted+e.bot_lost_coins))?t:0;this.coinsBalance$={title:"Total Coins Balance",subTitle:"Coins Balance",data:n,class:"coins-balance"}})}getCoinsWonStats(e,t,n,i){const a={start_date:e,end_date:t};i&&(a.game_id=i),n&&(a.level=n),this.coinsWonStats$=this.api.get(g.a.CoinsWon,{query:a}).pipe(Object(T.a)(e=>Object(C.a)([])),Object(O.a)(e=>{var t,n;return this.coinsWonReal$={title:"Coins Won by Real Players",subTitle:"Real Player Coins",data:e.real_player_coins_won,class:"coins-won-real"},this.coinsWonBot$={title:"Coins Won by Bots",subTitle:"Bot Coins",data:e.bot_coins_won,class:"coins-won-bot"},this.coinsWon$={title:"Coins Won",classSelector:"coins-won",viewType:"pie",data:[{type:"Real Players",result:(t=e.real_player_coins_won,null!=t?t:0)},{type:"Bots",result:(n=e.bot_coins_won,null!=n?n:0)}]},e}))}openUsersByTransaction(e){const{from:t,to:n}=this.date$.getValue(),i=Object(w.b)(t).format(k.c),a=Object(w.b)(n).format(k.c),s={transaction:k.e.RedeemCoinsRequest,start_date:i,end_date:a};e.name===k.b.PurchasedCount&&(s.transaction=k.e.Transaction,s.amount=e.amount),this.router.navigate(["/admin/users"],{queryParams:s})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(_.a),r.Pb($.a),r.Pb(be.a),r.Pb(m.b),r.Pb(i.f),r.Pb(i.d))},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-finance"]],decls:56,vars:46,consts:[[1,"row","container"],[4,"ngIf","ngIfElse"],[1,"divider"],[1,"date-filter"],[3,"formControl"],[1,"btn","custom","primary",3,"disabled","click"],[1,"row","container","purchased-container"],["loading",""],[1,"coins-won-header"],["ngbDropdown","",1,"d-inline-block"],["id","dropdownLevel","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["ngbDropdownMenu","","aria-labelledby","dropdownLevel"],[4,"ngFor","ngForOf"],["id","dropdownGames","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["ngbDropdownMenu","","aria-labelledby","dropdownGames"],["class","col-6",3,"metric",4,"ngFor","ngForOf"],[1,"col-6",3,"metric"],["class","purchased-metric pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"purchased-metric","pointer",3,"metric","click"],[1,"col","col-loading"],[1,"metric","loading"],["class","col-6 pointer",3,"metric","click",4,"ngFor","ngForOf"],[1,"col-6","pointer",3,"metric","click"],[1,"col-12",3,"metric"],[1,"col-4",3,"keenApiInput"],[1,"col-4",3,"metric"],["ngbDropdownItem","",3,"click"]],template:function(e,t){if(1&e&&(r.Vb(0,"h4"),r.Lc(1,"Coins"),r.Ub(),r.Vb(2,"div",0),r.Jc(3,pe,2,1,"ng-container",1),r.mc(4,"async"),r.Ub(),r.Qb(5,"div",2),r.Vb(6,"div",3),r.Qb(7,"duelit-date-picker-range",4),r.Vb(8,"button",5),r.hc("click",(function(){return t.updateDate()})),r.Lc(9,"Filter"),r.Ub(),r.Ub(),r.Vb(10,"h4"),r.Lc(11,"Purchased Product"),r.Ub(),r.Vb(12,"div",6),r.Jc(13,ge,2,1,"ng-container",1),r.mc(14,"async"),r.Ub(),r.Jc(15,he,2,0,"ng-template",null,7,r.Kc),r.Vb(17,"h4"),r.Lc(18,"Redeemed Coins"),r.Ub(),r.Vb(19,"div",0),r.Jc(20,ye,2,1,"ng-container",1),r.mc(21,"async"),r.Ub(),r.Vb(22,"h4"),r.Lc(23,"Total Profit"),r.Ub(),r.Vb(24,"div",0),r.Jc(25,Ce,2,1,"ng-container",1),r.mc(26,"async"),r.Ub(),r.Vb(27,"h4"),r.Lc(28,"Coins Earned/Lost"),r.Ub(),r.Vb(29,"div",0),r.Jc(30,ve,2,1,"ng-container",1),r.mc(31,"async"),r.Jc(32,Te,2,1,"ng-container",1),r.mc(33,"async"),r.Jc(34,Oe,2,1,"ng-container",1),r.mc(35,"async"),r.Ub(),r.Vb(36,"div",8),r.Vb(37,"h4"),r.Lc(38,"Coins Won"),r.Ub(),r.Vb(39,"div",9),r.Vb(40,"button",10),r.Lc(41),r.Ub(),r.Vb(42,"div",11),r.Jc(43,Se,3,3,"ng-container",12),r.Ub(),r.Ub(),r.Vb(44,"div",9),r.Vb(45,"button",13),r.Lc(46),r.Ub(),r.Vb(47,"div",14),r.Jc(48,ke,3,3,"ng-container",12),r.Ub(),r.Ub(),r.Ub(),r.Vb(49,"div",0),r.Jc(50,we,2,1,"ng-container",1),r.mc(51,"async"),r.Jc(52,_e,2,1,"ng-container",1),r.mc(53,"async"),r.Jc(54,$e,2,1,"ng-container",1),r.mc(55,"async"),r.Ub()),2&e){const e=r.zc(16);r.Cb(3),r.rc("ngIf",r.nc(4,26,t.totalCredits$))("ngIfElse",e),r.Cb(4),r.rc("formControl",t.rangeDate),r.Cb(1),r.rc("disabled",!t.isDateRangeValid()),r.Cb(5),r.rc("ngIf",r.nc(14,28,t.productsSold$))("ngIfElse",e),r.Cb(7),r.rc("ngIf",r.nc(21,30,t.redeemedStats$))("ngIfElse",e),r.Cb(5),r.rc("ngIf",r.nc(26,32,t.redeemedStats$))("ngIfElse",e),r.Cb(5),r.rc("ngIf",r.nc(31,34,t.coinsEarnedStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(33,36,t.coinsEarnedStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(35,38,t.coinsEarnedStats$))("ngIfElse",e),r.Cb(7),r.Mc(t.selectedLevel.value),r.Cb(2),r.rc("ngForOf",t.levels),r.Cb(3),r.Mc(t.getSelectedGameLabel()),r.Cb(2),r.rc("ngForOf",t.games),r.Cb(2),r.rc("ngIf",r.nc(51,40,t.coinsWonStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(53,42,t.coinsWonStats$))("ngIfElse",e),r.Cb(2),r.rc("ngIf",r.nc(55,44,t.coinsWonStats$))("ngIfElse",e)}},directives:[i.n,I.a,a.l,a.e,s.g,s.k,s.i,i.m,V.a,P.a,s.h],pipes:[i.b],styles:["[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   span.metric.loading[_ngcontent-%COMP%]{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .date-filter[_ngcontent-%COMP%]   .btn.custom.primary[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]  .revenue1 .c3-bar-1{fill:#fe6672!important}",".divider[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:20px}.coins-won-header[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:10px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-column-gap:20px;-moz-column-gap:20px;column-gap:20px}.coins-won-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:0}.purchased-container[_ngcontent-%COMP%]{gap:10px}.purchased-metric[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}"]}),e})();var Pe=n("PqYM"),Ue=n("l7GE"),xe=n("ZUHj");class Ae{constructor(e){this.notifier=e}call(e,t){return t.subscribe(new je(e,this.notifier,t))}}class je extends Ue.a{constructor(e,t,n){super(e),this.notifier=t,this.source=n,this.sourceIsBeingSubscribedTo=!0}notifyNext(e,t,n,i,a){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)}notifyComplete(e){if(!1===this.sourceIsBeingSubscribedTo)return super.complete()}complete(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return super.complete();this._unsubscribeAndRecycle(),this.notifications.next()}}_unsubscribe(){const{notifications:e,retriesSubscription:t}=this;e&&(e.unsubscribe(),this.notifications=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null}_unsubscribeAndRecycle(){const{_unsubscribe:e}=this;return this._unsubscribe=null,super._unsubscribeAndRecycle(),this._unsubscribe=e,this}subscribeToRetries(){let e;this.notifications=new f.a;try{const{notifier:t}=this;e=t(this.notifications)}catch(t){return super.complete()}this.retries=e,this.retriesSubscription=Object(xe.a)(this,e)}}var Ve=n("bOdf");const Re={asc:"desc",desc:"","":"asc"};let qe=(()=>{class e{constructor(){this.duelitSortable="",this.direction="",this.tableName="",this.sort=new r.o}get _t(){return!0}get isAscending(){return"asc"===this.direction}get isDescending(){return"desc"===this.direction}rotate(){this.direction=Re[this.direction],this.sort.emit({column:this.duelitSortable,direction:this.direction})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.Kb({type:e,selectors:[["th","duelitSortable",""]],hostVars:6,hostBindings:function(e,t){1&e&&r.hc("click",(function(e){return t.rotate(e)})),2&e&&r.Hb("pointer",t._t)("asc",t.isAscending)("desc",t.isDescending)},inputs:{duelitSortable:"duelitSortable",direction:"direction",tableName:"tableName"},outputs:{sort:"sort"}}),e})();function Ee(e,t){if(1&e){const e=r.Wb();r.Vb(0,"th",5),r.hc("sort",(function(t){return r.Cc(e),r.lc(2).onSort(t)})),r.Lc(1),r.Ub()}if(2&e){const e=t.$implicit;r.rc("duelitSortable",e),r.Cb(1),r.Mc(e.name)}}function De(e,t){if(1&e&&(r.Vb(0,"th",8),r.Lc(1),r.Ub()),2&e){const e=r.lc().$implicit;r.Cb(1),r.Mc(e)}}function Le(e,t){if(1&e&&(r.Vb(0,"td"),r.Lc(1),r.Ub()),2&e){const e=r.lc().$implicit;r.Cb(1),r.Mc(e)}}function Me(e,t){if(1&e&&(r.Tb(0),r.Jc(1,De,2,1,"th",6),r.Jc(2,Le,2,1,"ng-template",null,7,r.Kc),r.Sb()),2&e){const e=t.index,n=r.zc(3);r.Cb(1),r.rc("ngIf",0===e)("ngIfElse",n)}}function Je(e,t){if(1&e&&(r.Vb(0,"tr"),r.Jc(1,Me,4,2,"ng-container",4),r.Ub()),2&e){const e=t.$implicit;r.Cb(1),r.rc("ngForOf",e)}}function Fe(e,t){if(1&e&&(r.Vb(0,"table",2),r.Vb(1,"thead"),r.Vb(2,"tr"),r.Jc(3,Ee,2,2,"th",3),r.Ub(),r.Ub(),r.Vb(4,"tbody"),r.Jc(5,Je,2,1,"tr",4),r.Ub(),r.Ub()),2&e){const e=r.lc();r.Cb(3),r.rc("ngForOf",e.headerMapping),r.Cb(2),r.rc("ngForOf",e.tableData)}}function Qe(e,t){1&e&&r.Lc(0," No data to show.\n")}let Ne=(()=>{class e{constructor(){this.headerMapping=[],this.data=[],this.sort=new r.o,this.sortDirection=""}ngOnInit(){}getData(e,t){let n=t;return e.split(".").forEach(e=>n=n[e]),String(n)}get tableData(){return this.data.map(e=>this.headerMapping.map(t=>this.getData(t.path,e))).sort((e,t)=>{let n=this.headerMapping.indexOf(this.sortColumn);n<0&&(n=0);const i=(a=e[n])<(s=t[n])?-1:a>s?1:0;var a,s;return"desc"===this.sortDirection?-1*i:i})}onSort({column:e,direction:t}){this.headers.forEach(t=>{t.duelitSortable!==e&&(t.direction="")}),this.sortColumn=e,this.sortDirection=t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-table"]],viewQuery:function(e,t){var n;1&e&&r.Qc(qe,!0),2&e&&r.yc(n=r.ic())&&(t.headers=n)},inputs:{headerMapping:"headerMapping",data:"data",tableName:"tableName"},outputs:{sort:"sort"},decls:3,vars:2,consts:[["class","table table-striped",4,"ngIf","ngIfElse"],["noData",""],[1,"table","table-striped"],["scope","col",3,"duelitSortable","sort",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["scope","col",3,"duelitSortable","sort"],["scope","row",4,"ngIf","ngIfElse"],["td",""],["scope","row"]],template:function(e,t){if(1&e&&(r.Jc(0,Fe,6,2,"table",0),r.Jc(1,Qe,1,0,"ng-template",null,1,r.Kc)),2&e){const e=r.zc(2);r.rc("ngIf",t.data.length)("ngIfElse",e)}},directives:[i.n,i.m,qe],styles:['th.asc[_ngcontent-%COMP%]:before, th.desc[_ngcontent-%COMP%]:before{content:"";display:block;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAmxJREFUeAHtmksrRVEUx72fH8CIGQNJkpGUUmakDEiZSJRIZsRQmCkTJRmZmJgQE0kpX0D5DJKJgff7v+ru2u3O3vvc67TOvsdatdrnnP1Y///v7HvvubdbUiIhBISAEBACQkAICAEhIAQ4CXSh2DnyDfmCPEG2Iv9F9MPlM/LHyAecdyMzHYNwR3fdNK/OH9HXl1UCozD24TCvILxizEDWIEzA0FcM8woCgRrJCoS5PIwrANQSMAJX1LEI9bqpQo4JYNFFKRSvIgsxHDVnqZgIkPnNBM0rIGtYk9YOOsqgbgepRCfdbmFtqhFkVEDVPjJp0+Z6e6hRHhqBKgg6ZDCvYBygVmUoEGoh5JTRvIJwhJo1aUOoh4CLPMyvxxi7EWOMgnCGsXXI1GIXlZUYX7ucU+kbR8NW8lh3O7cue0Pk32MKndfUxQFAwxdirk3fHappAnc0oqDPzDfGTBrCfHP04dM4oTV8cxr0SVzH9FF07xD3ib6xCDE+M+aUcVygtWzzbtGX2rPBrEUYfecfQkaFzYi6HjVnGBdtL7epqAlc1+jRdAap74RrnPc4BCijttY2tRcdN0g17w7HqZrXhdJTYAuS3hd8z+vKgK3V1zWPae0mZDMykadBn1hTQBLnZNwVrJpSe/NwEeDsEwCctEOsJTsgxLvCqUl2ACftEGvJDgjxrnBqkh3ASTvEWrIDQrwrnJpkB3DSDrGW7IAQ7wqnJtkBnLRztejXXVu4+mxz/nQ9jR1w5VB86ejLTFcnnDwhzV+F6T+CHZlx6THSjn76eyyBIOPHyDakhBAQAkJACAgBISAEhIAQYCLwC8JxpAmsEGt6AAAAAElFTkSuQmCC") no-repeat;background-size:auto;background-size:22px;width:22px;height:22px;float:left;margin-left:-22px}th.desc[_ngcontent-%COMP%]:before{-webkit-transform:rotate(180deg);transform:rotate(180deg);-ms-transform:rotate(180deg)}']}),e})();function Be(e,t){1&e&&(r.Vb(0,"div",3),r.Qb(1,"span",4),r.Ub())}function Ge(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"duelit-table",5),r.Sb()),2&e){const e=t.$implicit,n=r.lc();r.Cb(1),r.rc("data",e)("headerMapping",n.tableHeadersMapping)}}let He=(()=>{class e{constructor(e){this.api=e,this.ngUnsubscribe=new f.a,this.POLL_INTERVAL=1e4,this.timer$=new y.a(this.POLL_INTERVAL/1e3),this._stop=new f.a,this._start=new f.a,this.tableHeadersMapping=[{name:"ID",path:"tournament_id"},{name:"Game Name",path:"game_name"},{name:"Joined Players",path:"total_players"},{name:"Real Players",path:"total_real_players"},{name:"Minimum Players",path:"minimum_players"},{name:"Status",path:"status"},{name:"Total Payout",path:"total_payout"},{name:"Level",path:"level"},{name:"Time Left",path:"time_left"}]}ngOnInit(){var e;Object(Pe.a)(0,1e3).pipe(Object(O.a)(e=>this.POLL_INTERVAL/1e3-e),Object(v.a)(this._stop),(e=()=>this._start,t=>t.lift(new Ae(e)))).subscribe(e=>{this.timer$.next(e)}),this.openTournaments$=Object(Pe.a)(0,this.POLL_INTERVAL).pipe(Object(Ve.a)(()=>this.api.get(g.d.GetOccupiedOpenTournaments).pipe(Object(T.a)(e=>Object(C.a)({})))),Object(O.a)((e={})=>{null===e&&(e={}),this.restartTimer();let t=this.getTournamentListByStatus(e,"Started");return t=this.mapTimeLeft(t),t}),Object(v.a)(this.ngUnsubscribe))}getTournamentListByStatus(e,t){return Object.keys(e).filter(n=>e[n].status===t).map(t=>e[t])}mapTimeLeft(e){const t=h();return e.filter(e=>{const n=h.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss");return 0===t.diff(n,"hours")}).map(e=>{const n=h.utc(e.timer.startAt,"DD/MM/YYYY h:mm:ss"),i=h.duration(t.diff(n)),a=10-i.minutes(),s=60-i.seconds();return e.time_left="",a>0&&(e.time_left+=`${a} mins `),e.time_left+=`${s} secs`,e})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}restartTimer(){this._stop.next(),this._start.next()}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(_.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-realtime"]],decls:9,vars:7,consts:[["loading",""],[1,"d-inline","pr-1"],[4,"ngIf","ngIfElse"],[1,"col","col-loading"],[1,"metric","loading"],[3,"data","headerMapping"]],template:function(e,t){if(1&e&&(r.Jc(0,Be,2,0,"ng-template",null,0,r.Kc),r.Vb(2,"h4",1),r.Lc(3,"Active Tournaments"),r.Ub(),r.Vb(4,"span"),r.Lc(5),r.mc(6,"async"),r.Ub(),r.Jc(7,Ge,2,2,"ng-container",2),r.mc(8,"async")),2&e){const e=r.zc(1);r.Cb(5),r.Nc("(Refreshing in ",r.nc(6,3,t.timer$)," seconds)"),r.Cb(2),r.rc("ngIf",r.nc(8,5,t.openTournaments$))("ngIfElse",e)}},directives:[i.n,Ne],pipes:[i.b],styles:[".col-loading[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;display:-webkit-box;display:flex}[_nghost-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}"]}),e})();function We(e,t){1&e&&r.Qb(0,"duelit-app-data")}function ze(e,t){1&e&&r.Qb(0,"duelit-finance")}function Ye(e,t){1&e&&r.Qb(0,"duelit-realtime")}const Ke=[{path:"",component:(()=>{class e{constructor(){this.activeTab="Application Data"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Jb({type:e,selectors:[["duelit-dashboard"]],decls:18,vars:2,consts:[["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],["ngbNavItem","Application Data"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","Finance"],["ngbNavItem","Realtime Data"],[1,"timezone"],[1,"mt-2",3,"ngbNavOutlet"]],template:function(e,t){if(1&e&&(r.Vb(0,"ul",0,1),r.hc("activeIdChange",(function(e){return t.activeTab=e})),r.Vb(2,"li",2),r.Vb(3,"a",3),r.Lc(4,"App"),r.Ub(),r.Jc(5,We,1,0,"ng-template",4),r.Ub(),r.Vb(6,"li",5),r.Vb(7,"a",3),r.Lc(8,"Finance"),r.Ub(),r.Jc(9,ze,1,0,"ng-template",4),r.Ub(),r.Vb(10,"li",6),r.Vb(11,"a",3),r.Lc(12,"Realtime"),r.Ub(),r.Jc(13,Ye,1,0,"ng-template",4),r.Ub(),r.Vb(14,"li",7),r.Vb(15,"span"),r.Lc(16,"Timezone: UTC"),r.Ub(),r.Ub(),r.Ub(),r.Qb(17,"div",8)),2&e){const e=r.zc(1);r.rc("activeId",t.activeTab),r.Cb(17),r.rc("ngbNavOutlet",e)}},directives:[s.o,s.q,s.r,s.p,s.t,ue,Ie,He],styles:[".timezone[_ngcontent-%COMP%]{display:-webkit-box;display:flex;float:right;-webkit-box-flex:1;flex-grow:1;-webkit-box-pack:right;justify-content:right;-webkit-box-align:center;align-items:center;padding-right:1em}"]}),e})()}];let Xe=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[m.e.forChild(Ke)],m.e]}),e})();n.d(t,"DashboardModule",(function(){return Ze}));let Ze=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},providers:[i.f,i.d],imports:[[i.c,Xe,s.s,s.j,c.a,a.q,u,b,d.a,p.a,l]]}),e})()}}]);