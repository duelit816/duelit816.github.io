function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{R5Mc:function(t,e,n){"use strict";n.r(e);var i=n("ofXK"),r=n("3Pt+"),a=n("+0xr"),o=n("6NWb"),c=n("1kSV"),s=n("2Did"),b=n("tyNb"),l=n("twK/"),d=n("Znnd"),u=n("SMdK"),f=n("wd/R"),m=n("5yfJ"),p=n("LRne"),g=n("vkgz"),h=n("JIr8"),C=n("lJxs"),v=n("fXoL"),U=n("qc5V"),y=n("Olgc");function V(t,e){if(1&t&&(v.Vb(0,"option",41),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.rc("value",n),v.Cb(1),v.Mc(n)}}function D(t,e){if(1&t&&(v.Vb(0,"select",39),v.Jc(1,V,2,2,"option",40),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.rc("ngForOf",n)}}function w(t,e){if(1&t&&(v.Vb(0,"option",41),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.rc("value",n),v.Cb(1),v.Mc(n)}}function I(t,e){if(1&t&&(v.Vb(0,"select",43),v.Jc(1,w,2,2,"option",40),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.rc("ngForOf",n)}}function L(t,e){if(1&t&&(v.Vb(0,"div",15),v.Vb(1,"label"),v.Lc(2,"State / Province"),v.Ub(),v.Jc(3,I,2,1,"select",42),v.mc(4,"async"),v.Ub()),2&t){v.lc();var n=v.zc(21),i=v.lc();v.Cb(3),v.rc("ngIf",v.nc(4,2,i.states$))("ngIfElse",n)}}function P(t,e){1&t&&v.Qb(0,"input",44)}function k(t,e){1&t&&(v.Vb(0,"div",11),v.Vb(1,"label"),v.Lc(2,"Ban Description"),v.Ub(),v.Qb(3,"input",45),v.Ub())}function O(t,e){if(1&t){var n=v.Wb();v.Vb(0,"div",10),v.Vb(1,"div",11),v.Vb(2,"label"),v.Lc(3,"First Name"),v.Ub(),v.Qb(4,"input",12),v.Ub(),v.Vb(5,"div",11),v.Vb(6,"label"),v.Lc(7,"Last Name"),v.Ub(),v.Qb(8,"input",13),v.Ub(),v.Vb(9,"div",11),v.Vb(10,"label"),v.Lc(11,"Email"),v.Ub(),v.Qb(12,"input",14),v.Ub(),v.Vb(13,"div",0),v.Vb(14,"div",15),v.Vb(15,"label"),v.Lc(16,"Country"),v.Ub(),v.Jc(17,D,2,1,"select",16),v.mc(18,"async"),v.Ub(),v.Jc(19,L,5,4,"div",17),v.Jc(20,P,1,0,"ng-template",null,18,v.Kc),v.Ub(),v.Vb(22,"div",0),v.Vb(23,"div",19),v.Vb(24,"label"),v.Lc(25,"Birthday"),v.Ub(),v.Vb(26,"div",20),v.Qb(27,"input",21,22),v.Vb(29,"div",23),v.Vb(30,"button",24),v.hc("click",(function(){return v.Cc(n),v.zc(28).toggle()})),v.Qb(31,"fa-icon",25),v.Ub(),v.Ub(),v.Ub(),v.Ub(),v.Vb(32,"div",19),v.Vb(33,"label"),v.Lc(34,"Status"),v.Ub(),v.Vb(35,"select",26),v.Vb(36,"option",27),v.Lc(37,"Active"),v.Ub(),v.Vb(38,"option",28),v.Lc(39,"Inactive"),v.Ub(),v.Vb(40,"option",29),v.Lc(41,"Pending"),v.Ub(),v.Vb(42,"option",30),v.Lc(43,"Deactivated"),v.Ub(),v.Vb(44,"option",31),v.Lc(45,"Banned"),v.Ub(),v.Ub(),v.Ub(),v.Ub(),v.Jc(46,k,4,0,"div",32),v.Vb(47,"div",0),v.Vb(48,"div",15),v.Vb(49,"label"),v.Lc(50,"Role"),v.Ub(),v.Vb(51,"select",33),v.Vb(52,"option",34),v.Lc(53,"Admin"),v.Ub(),v.Vb(54,"option",35),v.Lc(55,"Developer"),v.Ub(),v.Vb(56,"option",36),v.Lc(57,"Player"),v.Ub(),v.Ub(),v.Ub(),v.Ub(),v.Vb(58,"button",37),v.hc("click",(function(){return v.Cc(n),v.lc().updateUser()})),v.Lc(59,"Save"),v.Ub(),v.Vb(60,"button",38),v.hc("click",(function(){return v.Cc(n),v.lc().deleteUser()})),v.Lc(61,"Delete"),v.Ub(),v.Ub()}if(2&t){var i=v.zc(21),r=v.lc();v.rc("formGroup",r.userDetailsForm),v.Cb(17),v.rc("ngIf",v.nc(18,8,r.countries$))("ngIfElse",i),v.Cb(2),v.rc("ngIf","United States"===r.userDetailsForm.get("country").value),v.Cb(12),v.rc("icon",r.calendarIcon),v.Cb(15),v.rc("ngIf","banned"===r.userDetailsForm.get("status").value),v.Cb(12),v.rc("disabled",r.userDetailsForm.invalid||r.isSavingUser||r.isDeleting),v.Cb(2),v.rc("disabled",r.isDeleting)}}function N(t,e){if(1&t){var n=v.Wb();v.Vb(0,"div",46),v.Vb(1,"label"),v.Lc(2),v.Ub(),v.Vb(3,"div",47),v.Qb(4,"input",48),v.Vb(5,"button",49),v.hc("click",(function(){return v.Cc(n),v.lc().updateCredits()})),v.Lc(6,"Update"),v.Ub(),v.Ub(),v.Ub()}if(2&t){var i=e.$implicit,r=v.lc();v.Cb(2),v.Nc("Credits - ",i.virtualAmount,""),v.Cb(2),v.rc("formControl",r.userCreditsControl)("disabled",r.isCreditsUpdating),v.Cb(1),v.rc("disabled",r.isCreditsUpdating||r.isDeleting)}}function S(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," ID "),v.Ub())}function _(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.transactionId||"-"," ")}}function J(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Date "),v.Ub())}function M(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.createdAt," ")}}function x(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Type "),v.Ub())}function $(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.type," ")}}function j(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Game ID "),v.Ub())}function E(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.gameId||"-"," ")}}function T(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Game Name "),v.Ub())}function F(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.gameName||"-"," ")}}function H(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Product "),v.Ub())}function Q(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.productId," ")}}function R(t,e){1&t&&(v.Vb(0,"th",63),v.Lc(1," Amount "),v.Ub())}function B(t,e){if(1&t&&(v.Vb(0,"td",64),v.Lc(1),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.Nc(" ",n.amount," ")}}function Y(t,e){1&t&&v.Qb(0,"tr",65)}function A(t,e){1&t&&v.Qb(0,"tr",66)}var G=function(){return["transactionId","createdAt","type","gameId","gameName","productId","amount"]};function z(t,e){if(1&t&&(v.Vb(0,"div",50),v.Vb(1,"table",51),v.Tb(2,52),v.Jc(3,S,2,0,"th",53),v.Jc(4,_,2,1,"td",54),v.Sb(),v.Tb(5,55),v.Jc(6,J,2,0,"th",53),v.Jc(7,M,2,1,"td",54),v.Sb(),v.Tb(8,56),v.Jc(9,x,2,0,"th",53),v.Jc(10,$,2,1,"td",54),v.Sb(),v.Tb(11,57),v.Jc(12,j,2,0,"th",53),v.Jc(13,E,2,1,"td",54),v.Sb(),v.Tb(14,58),v.Jc(15,T,2,0,"th",53),v.Jc(16,F,2,1,"td",54),v.Sb(),v.Tb(17,59),v.Jc(18,H,2,0,"th",53),v.Jc(19,Q,2,1,"td",54),v.Sb(),v.Tb(20,60),v.Jc(21,R,2,0,"th",53),v.Jc(22,B,2,1,"td",54),v.Sb(),v.Jc(23,Y,1,0,"tr",61),v.Jc(24,A,1,0,"tr",62),v.Ub(),v.Ub()),2&t){var n=e.$implicit;v.Cb(1),v.rc("dataSource",n),v.Cb(22),v.rc("matHeaderRowDef",v.uc(4,G))("matHeaderRowDefSticky",!0),v.Cb(1),v.rc("matRowDefColumns",v.uc(5,G))}}function K(t,e){1&t&&(v.Vb(0,"div",67),v.Qb(1,"span",68),v.Ub())}var q,W,X=[{path:"",component:(q=function(){function t(e,n,i,r,a,o){_classCallCheck(this,t),this.route=e,this.api=n,this.fb=i,this.calendar=r,this.toast=a,this.router=o,this.calendarIcon=l.a,this.isSavingUser=!1,this.isCreditsUpdating=!1,this.isDeleting=!1}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this,e=this.route.snapshot.params.userId,n=this.api.buildPath(d.d.GetUserById,[e]);this.user$=this.api.get(n).pipe(Object(g.a)((function(e){var n=f(e.birthDate).toObject(),i=t.calendar.getToday();i.day=n.date,i.month=n.months+1,i.year=n.years,t.userDetailsForm=t.fb.group({firstName:new r.d(e.firstName),lastName:new r.d(e.lastName),email:new r.d(e.email,[u.a,r.s.required]),country:new r.d(e.country),state:new r.d(e.state),birthDate:new r.d(i),status:new r.d(e.status),role:new r.d(e.role),banDescription:new r.d(e.banDescription)})})),Object(h.a)((function(e){return t.toast.error(e.error||e.statusText||e.message),t.router.navigate(["/admin/users"]),m.a})));var i=this.api.buildPath(d.b.CreditsByUser,[e]);this.userCredits$=this.api.get(i),this.getUserCreditHistory(),this.countries$=this.api.get(d.e.Countries).pipe(Object(C.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return t.name}))}))),this.states$=this.api.get(d.e.States).pipe(Object(C.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return t.name}))}))),this.userCreditsControl=new r.d(0)}},{key:"getUserCreditHistory",value:function(){var t=this.api.buildPath(d.b.CreditsHistoryByUser,[this.route.snapshot.params.userId]);this.userCreditsHistory$=this.api.get(t)}},{key:"updateUser",value:function(){var t=this,e=this.userDetailsForm.value,n=f().year(e.birthDate.year).month(e.birthDate.month-1).date(e.birthDate.day).format("YYYY-MM-DD"),i={first_name:e.firstName,last_name:e.lastName,email:e.email,country:e.country,state:e.state,role:e.role,status:e.status,banDescription:"banned"===e.status?e.banDescription:"",birth_date:n};this.isSavingUser=!0,this.api.post(d.d.UpdateUser,{body:i,opts:{addSecurity:!1}}).pipe(Object(g.a)((function(){return t.isSavingUser=!1})),Object(h.a)((function(e){return t.isSavingUser=!1,t.toast.error(e.error||e.statusText||e.message),m.a}))).subscribe((function(){t.toast.success("Successfully updated user details.")}))}},{key:"updateCredits",value:function(){var t=this;this.isCreditsUpdating=!0;var e=this.route.snapshot.params.userId,n=this.userCreditsControl.value;this.userCreditsControl.disable();var i=this.api.buildPath(d.b.CreditsByUser,[e]);this.api.post(i,{body:{virtual_amount:n},opts:{addSecurity:!1}}).pipe(Object(g.a)((function(){t.isCreditsUpdating=!1,t.userCreditsControl.enable(),t.userCreditsControl.setValue(0)})),Object(h.a)((function(e){return t.isCreditsUpdating=!1,t.userCreditsControl.enable(),t.toast.error(e.error||e.statusText||e.message),m.a}))).subscribe((function(e){t.userCredits$=Object(p.a)(e),t.getUserCreditHistory(),t.toast.success("Successfully updated user credits.")}))}},{key:"openUserStats",value:function(){this.router.navigate(["/admin/user",this.route.snapshot.params.userId,"stats"])}},{key:"deleteUser",value:function(){var t=this,e=this.route.snapshot.params.userId;this.isDeleting=!0;var n=this.api.buildPath(d.d.GetUserById,[e]);this.api.delete(n).pipe(Object(h.a)((function(e){return 200===e.status?Object(p.a)({}):(t.toast.error(e.error||e.statusText||e.message),t.isDeleting=!1,m.a)}))).subscribe((function(){t.toast.success("Successfully deleted user ".concat(t.userDetailsForm.value.email)),t.router.navigate(["/admin/users"])}))}}]),t}(),q.\u0275fac=function(t){return new(t||q)(v.Pb(b.a),v.Pb(U.a),v.Pb(r.c),v.Pb(c.a),v.Pb(y.a),v.Pb(b.b))},q.\u0275cmp=v.Jb({type:q,selectors:[["duelit-user-edit"]],decls:23,vars:13,consts:[[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-header","d-flex"],[1,"btn","btn-primary","custom",3,"disabled","click"],["class","card-body",3,"formGroup",4,"ngIf","ngIfElse"],[1,"card-header"],["class","card-body form-group",4,"ngIf","ngIfElse"],["class","card-body credit-history",4,"ngIf","ngIfElse"],["loading",""],[1,"card-body",3,"formGroup"],[1,"form-group"],["type","text","formControlName","firstName",1,"form-control"],["type","text","formControlName","lastName",1,"form-control"],["type","email","formControlName","email","readonly","","disabled","",1,"form-control"],[1,"col-6","form-group"],["class","form-control","formControlName","country","aria-placeholder","Select Country",4,"ngIf","ngIfElse"],["class","col-6 form-group",4,"ngIf"],["loadingSelect",""],[1,"col","form-group"],[1,"input-group"],["placeholder","YYYY-MM-DD","formControlName","birthDate","ngbDatepicker","",1,"form-control"],["d","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],[3,"icon"],["formControlName","status",1,"form-control"],["value","active"],["value","inactive"],["value","pending"],["value","deactivated"],["value","banned"],["class","form-group",4,"ngIf"],["formControlName","role",1,"form-control"],["value","admin"],["value","developer"],["value","player"],[1,"btn","btn-primary","custom","col",3,"disabled","click"],[1,"btn","btn-danger","custom","col",3,"disabled","click"],["formControlName","country","aria-placeholder","Select Country",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","form-control","formControlName","states","aria-placeholder","Select States / Province",4,"ngIf","ngIfElse"],["formControlName","states","aria-placeholder","Select States / Province",1,"form-control"],["readonly","","disabled","","type","text","placeholder","Loading...",1,"form-control-plaintext"],["type","text","formControlName","banDescription",1,"form-control"],[1,"card-body","form-group"],[1,"credits","d-flex"],["type","number","min","0",1,"form-control","col-6",3,"formControl","disabled"],[1,"btn","btn-primary","custom","col-5",3,"disabled","click"],[1,"card-body","credit-history"],["mat-table","",3,"dataSource"],["matColumnDef","transactionId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","type"],["matColumnDef","gameId"],["matColumnDef","gameName"],["matColumnDef","productId"],["matColumnDef","amount"],["mat-header-row","","class","named-columns",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"named-columns"],["mat-row",""],[1,"loading-container","d-flex"],[1,"loading"]],template:function(t,e){if(1&t&&(v.Vb(0,"div",0),v.Vb(1,"div",1),v.Vb(2,"div",2),v.Vb(3,"div",3),v.Vb(4,"span"),v.Lc(5,"User Details"),v.Ub(),v.Vb(6,"button",4),v.hc("click",(function(){return e.openUserStats()})),v.Lc(7,"View user stats"),v.Ub(),v.Ub(),v.Jc(8,O,62,10,"div",5),v.mc(9,"async"),v.Ub(),v.Ub(),v.Vb(10,"div",1),v.Vb(11,"div",2),v.Vb(12,"div",6),v.Lc(13," Edit Credits "),v.Ub(),v.Jc(14,N,7,4,"div",7),v.mc(15,"async"),v.Ub(),v.Vb(16,"div",2),v.Vb(17,"div",6),v.Lc(18," Credits History "),v.Ub(),v.Jc(19,z,25,6,"div",8),v.mc(20,"async"),v.Ub(),v.Ub(),v.Ub(),v.Jc(21,K,2,0,"ng-template",null,9,v.Kc)),2&t){var n=v.zc(22);v.Cb(6),v.rc("disabled",e.isDeleting),v.Cb(2),v.rc("ngIf",v.nc(9,7,e.user$))("ngIfElse",n),v.Cb(6),v.rc("ngIf",v.nc(15,9,e.userCredits$))("ngIfElse",n),v.Cb(5),v.rc("ngIf",v.nc(20,11,e.userCreditsHistory$))("ngIfElse",n)}},directives:[i.m,r.m,r.g,r.b,r.l,r.f,c.k,o.a,r.r,r.o,r.t,i.l,r.p,r.e,a.j,a.c,a.e,a.b,a.g,a.i,a.d,a.a,a.f,a.h],pipes:[i.b],styles:[".card-header[_ngcontent-%COMP%]{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.card-header[_ngcontent-%COMP%]   button.custom[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]     span.loading{height:120px;width:120px;background-size:120px 120px}[_nghost-%COMP%]   .loading-container[_ngcontent-%COMP%]{min-width:120px;-webkit-box-pack:center;justify-content:center}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{margin-bottom:2rem}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background-color:#fff;font-weight:700}[_nghost-%COMP%]   .credits[_ngcontent-%COMP%]{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}[_nghost-%COMP%]   .credit-history[_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   .credit-history[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-family:Nexa;width:100%}[_nghost-%COMP%]   .credit-history[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]{padding-right:1em}"]}),q)}],Z=((W=function t(){_classCallCheck(this,t)}).\u0275mod=v.Nb({type:W}),W.\u0275inj=v.Mb({factory:function(t){return new(t||W)},imports:[[b.e.forChild(X)],b.e]}),W);n.d(e,"UserEditModule",(function(){return et}));var tt,et=((tt=function t(){_classCallCheck(this,t)}).\u0275mod=v.Nb({type:tt}),tt.\u0275inj=v.Mb({factory:function(t){return new(t||tt)},imports:[[i.c,Z,s.a,r.q,c.e,o.b,a.l]]}),tt)}}]);